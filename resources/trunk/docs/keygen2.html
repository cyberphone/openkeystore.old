<!DOCTYPE html><html><head><title>KeyGen2 - Credential Enrollment and Management Protocol</title><meta http-equiv=Content-Type content="text/html; charset=utf-8"><style type="text/css">
.tftable {border-collapse: collapse}
.tftable th {font-size:10pt;background: linear-gradient(to bottom, #eaeaea 14%,#fcfcfc 52%,#e5e5e5 89%);border-width:1px;padding:4pt 10pt 4pt 10pt;border-style:solid;border-color: #a9a9a9;text-align:center;font-family:arial,verdana,helvetica}
.tftable tr {background-color:#FFFFE0}
.tftable td {font-size:10pt;border-width:1px;padding:4pt 8pt 4pt 8pt;border-style:solid;border-color:#a9a9a9;;font-family:arial,verdana,helvetica}
div {font-size:10pt;padding:10pt 0pt 0pt 0pt;font-family:arial,verdana,helvetica}
a:link {color:blue;font-family:verdana,helvetica;text-decoration:none}a:visited {color:blue;font-family:verdana,helvetica;text-decoration:none}a:active {color:blue;font-family:verdana,helvetica;text-decoration:none}</style></head><body style="margin:15pt"><div style="position:absolute;top:5pt;left:15pt;z-index:5;visibility:visible"><a href="http://webpki.org" title="WebPKI.org"><img src="data:image/gif;base64,R0lGODlhggBBANUAAAAAAP///+0bI+4pMe84P/BGTPJUWvNjaPRxdvV/hPaNkfebnviprPm3uvrGyP3i4/zU1nBxtMvL5NjY6uXl8fLy+C4wkjs9mUhKoFVXp2JkrX1+u4qLwpeYyaOkz7Cx1r2+3f7x8e7u7t3d3czMzLu7u6qqqpmZmYiIiHd3d2ZmZlVVVURERDMzMyIiIhEREQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAggBBAAAG/8CAcEgsGo/IpHLJbDqf0Kh0Sq1ar9isdsvter/gsHhMLpvP6LR6zW673/C4fE6v2+/hT2eSpFSSIB0SURIWGlAPCoqLCgwOSA4Kj0cLCgtEDAoPXR4WG0kbHkkZFnxQhYdPDgKsra0DCkYKArFFIQUCAxBEBgKTWxMWGEgVFxlIFBYXUqhQqwSMCgm4AghFs7VDtwIFm7y+XhcWFEcfFqXlFhHMhs4CBkcOAwIMRNhE2wUhRr2/WxsWRBkh5elIBAsf2KVysgoepXf2aA2BgEvfkX5ezK0rEkzchT9FxJEzIkGCKZLthkwomaQhkhCsItaCMO/AvovguiRbVgTgBv8MCDlaOEakwgZx5y50ADmkWYUOSM9FGEnEJZKYQ+7RrKYEoxdSg4YUK9WJ6JAOFjgQmYA0gwaCGU4GQFUB7ttzQatCPAJBAAGZ8rh2zdmFQ1oi5o5VOCcXrFigGqhSAJiBaaEMpKYOoXDQAgi9DvkJFjKLmrUlXrtcJkIqYQCAaoUstkDE8Ccj5mLPxeu6pzKmVrU16DXAG+lW9Zik7nIO5E6QhXgGAKFu828kGj4KKVQd+2Ehq1yJJ7Arot+bqAl3OejaNhGgrgEKDNCpA6C83OUWiT4kvPgCBzCAXlatWJSeP1x0cps4cnWSClBU+dTBhBRW+F0hwyghEnh7NTH/yzTcDIgTglvsFEBiRSQzTjAZCqEBXjDGmFIzSrwYVnBMYJOPiEUs1wVQE7zY2xAHcaAgES9WqCSFrtGYhI0chpajRDsm4SMXsF1XBHUXvPgZkRYwtQR/Go4T5RP3BFDliGFQd85tRgDVHBGdfMlEfkmQGQCOS6SpZkVIXLnFbBaEZQRaKVm3UBF19cbdRke8qBufSvj552jfkMgFKS0aoaJ9vg05BECQchfQEZ1od6YTll56WqZioDVfpOgwKs5STb14AVWXAaWZEJydY+eeHU6ZzRAPzPOqEIICE6YSH0jHEVIaaCDnBXKhMoGcbhF0gaiUJtGqEFst2+wWuiWR/26KAOF1wQZi7nZIBRxE5QlV/RXbp0R8KTvEuXSUZCgTKw2Mx8EIJ6zwwgw37PDDEEcscRsAVGzxxRhnrPHGHHfs8ccghzzxyCSXbPLJKKesMhgjoIBCCimMAIYJLrssAhknuKwCCjKrQUIKNwdAggskgAGAzCi4IIYILBQtRAknrNFC0EKcsILRQ7wghgomFNEzGiSwUIQIAGAdAApRh6F1GiRQ/bTYRZT9BQAkvPC12WgAgILXALg9wtVznw14GC2UMAQJKgwORttG7EwECk57IfcKe4dhwtRDuLwG0yqUUAIKhn9hAgBdi+BC12GgwMIJUK+Q9hojlBD5yZ7fvRTy7bjnrvvuvPfu++/ABy/88EQEAQA7" style="border-width:1px;border-style:solid;border-color:blue;box-shadow:3pt 3pt 3pt #D0D0D0" alt="WebPKI.org logo..."></a></div><div style="width:1000pt"><div style="margin-top:200pt;margin-bottom:200pt;text-align:center"><span style="font-size:28pt;font-family:'Times New Roman',Times,Serif">KeyGen2</span><br><span style="font-size:14pt">&nbsp;<br>Credential Enrollment and Management Protocol</span></div></div><div style="width:1000pt"><table style="border-width:1px;padding:4pt 10pt 4pt 10pt;border-style:solid;border-color: #808080;margin-left:auto;margin-right:auto;box-shadow:3pt 3pt 3pt #D0D0D0;margin-bottom:20pt"><tr><td><i>Disclaimer</i>: This is a system in development. That is, the specification may change without notice.</td></tr></table></div><div><span style="font-size:14pt;font-family:arial,verdana,helvetica">Table of Contents</span><table style="margin-left:20pt;margin-top:5pt"><tr style="white-space: nowrap"><td style="text-align:right"><a href="#Introduction">1.&nbsp;</a></td><td colspan="3"><a href="#Introduction">Introduction</a></td></tr><tr style="white-space: nowrap"><td style="text-align:right"><a href="#KeyGen2_Proxy">2.&nbsp;</a></td><td colspan="3"><a href="#KeyGen2_Proxy">KeyGen2 Proxy</a></td></tr><tr style="white-space: nowrap"><td style="text-align:right"><a href="#Protocol_Description">3.&nbsp;</a></td><td colspan="3"><a href="#Protocol_Description">Protocol Description</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td style="text-align:right"><a href="#Invocation">3.1.&nbsp;</a></td><td colspan="1"><a href="#Invocation">Invocation</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td style="text-align:right"><a href="#Error_Handling">3.2.&nbsp;</a></td><td colspan="1"><a href="#Error_Handling">Error Handling</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td style="text-align:right"><a href="#Key_Management_Operations">3.3.&nbsp;</a></td><td colspan="1"><a href="#Key_Management_Operations">Key Management Operations</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td style="text-align:right"><a href="#Deferred_Issuance">3.4.&nbsp;</a></td><td colspan="1"><a href="#Deferred_Issuance">Deferred Issuance</a></td></tr><tr style="white-space: nowrap"><td style="text-align:right"><a href="#Notation">4.&nbsp;</a></td><td colspan="3"><a href="#Notation">Notation</a></td></tr><tr style="white-space: nowrap"><td style="text-align:right"><a href="#Data_Types">5.&nbsp;</a></td><td colspan="3"><a href="#Data_Types">Data Types</a></td></tr><tr style="white-space: nowrap"><td style="text-align:right"><a href="#KeyGen2_Objects">6.&nbsp;</a></td><td colspan="3"><a href="#KeyGen2_Objects">KeyGen2 Objects</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#PlatformNegotiationRequest">PlatformNegotiationRequest</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#PlatformNegotiationResponse">PlatformNegotiationResponse</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#ProvisioningInitializationRequest">ProvisioningInitializationRequest</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#ProvisioningInitializationResponse">ProvisioningInitializationResponse</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#CredentialDiscoveryRequest">CredentialDiscoveryRequest</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#CredentialDiscoveryResponse">CredentialDiscoveryResponse</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#KeyCreationRequest">KeyCreationRequest</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#KeyCreationResponse">KeyCreationResponse</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#ProvisioningFinalizationRequest">ProvisioningFinalizationRequest</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#ProvisioningFinalizationResponse">ProvisioningFinalizationResponse</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#KeyManagementKey">KeyManagementKey</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#UpdatableKeyManagementKeys">UpdatableKeyManagementKeys</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#VirtualMachine">VirtualMachine</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#LookupSpecifiers">LookupSpecifiers</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#SearchFilter">SearchFilter</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#LookupResults">LookupResults</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#MatchingCredentials">MatchingCredentials</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#PUKPolicySpecifiers">PUKPolicySpecifiers</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#PINPolicySpecifiers">PINPolicySpecifiers</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#KeyEntrySpecifiers">KeyEntrySpecifiers</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#GeneratedKeys">GeneratedKeys</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#IssuedCredentials">IssuedCredentials</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#CloneKeyProtection">CloneKeyProtection</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#DeleteKeys">DeleteKeys</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#UnlockKeys">UnlockKeys</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#UpdateKey">UpdateKey</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#EncryptedExtensions">EncryptedExtensions</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#Extensions">Extensions</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#Logotypes">Logotypes</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#PropertyBags">PropertyBags</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#Properties">Properties</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#ImportPrivateKey">ImportPrivateKey</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#ImportSymmetricKey">ImportSymmetricKey</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#ClientAttributes">ClientAttributes</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#ImagePreferences">ImagePreferences</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#DeviceCertificate">DeviceCertificate</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#ServerEphemeralKey">ServerEphemeralKey</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#ClientEphemeralKey">ClientEphemeralKey</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#Signature">Signature</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#KeyInfo">KeyInfo</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#PublicKey">PublicKey</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#EC">EC</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#RSA">RSA</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#SignatureCertificate">SignatureCertificate</a></td></tr></table><table style="margin-left:20pt;margin-top:5pt"><tr style="white-space: nowrap"><td style="text-align:right"><a href="#Sample_Run">Appendix A:&nbsp;</a></td><td colspan="1"><a href="#Sample_Run">Sample Run</a></td></tr><tr style="white-space: nowrap"><td style="text-align:right"><a href="#Aknowledgements">Appendix B:&nbsp;</a></td><td colspan="1"><a href="#Aknowledgements">Aknowledgements</a></td></tr><tr style="white-space: nowrap"><td style="text-align:right"><a href="#References">Appendix C:&nbsp;</a></td><td colspan="1"><a href="#References">References</a></td></tr><tr style="white-space: nowrap"><td style="text-align:right"><a href="#Document_History">Appendix D:&nbsp;</a></td><td colspan="1"><a href="#Document_History">Document History</a></td></tr><tr style="white-space: nowrap"><td style="text-align:right"><a href="#Author">Appendix E:&nbsp;</a></td><td colspan="1"><a href="#Author">Author</a></td></tr></table></div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Introduction"><span style="font-size:14pt">1.&nbsp;Introduction</span></div>KeyGen2 is a web-based protocol for enrolling and managing credentials like X.509 certificates <a href="#Reference.RFC5280">[RFC5280]</a>. The protocol is a part of a security architecture which at the core consists of SKS (Secure Key Store) <a href="#Reference.SKS">[SKS]</a>.<div style="height:6pt;padding:0px"></div> The KeyGen2 protocol is expressed as a set of JSON <a href="#Reference.RFC4627">[RFC4627]</a> objects. This document contains a description of these objects and how they interact, while the integration with the SKS API is dealt with in the SKS architecture document <a href="#Reference.SKS">[SKS]</a>.<div style="height:6pt;padding:0px"></div>Parts of the protocol rely on cryptographic constructs using JSON which initially were created for the KeyGen2 project, but later became an activity of its own: JSON Cleartext Signature <a href="#Reference.JCS">[JCS]</a>.<div style="height:6pt;padding:0px"></div>Finding the proper balance in a complex scheme like KeyGen2 is a combination of &quot;gut feeling&quot;, political considerations, available technology, foresight and market research. If this particular specification hit the right level only time can tell.<table style="margin-top:20pt;margin-bottom:20pt;margin-left:auto;margin-right:auto;text-align:center"><tr><td>&quot;<i>Perfection&nbsp;is&nbsp;achieved,&nbsp;not&nbsp;when&nbsp;there&nbsp;is&nbsp;nothing&nbsp;more<br>to&nbsp;add,&nbsp;but&nbsp;when&nbsp;there&nbsp;is&nbsp;nothing&nbsp;left&nbsp;to&nbsp;take&nbsp;away</i>&quot;</td></tr><tr><td style="padding-top:4pt;font-size:8pt;text-align:right">Antoine de Saint-Exup√©ry</td></tr></table></div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="KeyGen2_Proxy"><span style="font-size:14pt">2.&nbsp;KeyGen2 Proxy</span></div>Unlike certificate management protocols like CMP <a href="#Reference.RFC4210">[RFC4210]</a>, <i>KeyGen2 mandates a two-layer client architecture</i> where the outermost part is talking to the outside world (user and issuer), while an inner part does the communication with the SKS. That is, the client implementation acts as &quot;proxy&quot; enabling the use of a cleartext, JSON-based, fairly high-level protocol with issuer, in spite of the fact that SKS only deals with low-level binary data.<div style="height:6pt;padding:0px"></div>Another core proxy task is minimizing network roundtrips through SKS command aggregation.<div style="height:6pt;padding:0px"></div>Although KeyGen2 depends on a proxy for doing the &quot;Heavy Lifting&quot;, E2ES (End To End Security) is achieved through the use of a <i>dynamically created shared secret</i>, which is only known by the SKS and the issuer. <div style="height:6pt;padding:0px"></div>For a detailed description of the proxy scheme and the E2ES solution, consult the SKS architecture document <a href="#Reference.SKS">[SKS]</a>.</div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Protocol_Description"><span style="font-size:14pt">3.&nbsp;Protocol Description</span></div>This chapter contains a high-level description of the KeyGen2 protocol while the subsequent chapters cover the actual format. <div style="height:6pt;padding:0px"></div>To facilitate a straightforward implementation as well as robust operation, KeyGen2 builds on a concept where each major process step is handled by a specific request/response pair as outlined below:<table style="width:600pt;margin-top:10pt;margin-left:auto;margin-right:auto;border-collapse:collapse"><tr><td style="padding:0px"><div style="margin-left:auto;margin-right:auto;height:10pt;width:2pt;background-color:#909090"></div></td><td></td></tr><tr><td style="padding:0px"><div style="padding:20pt;font-size:14pt;text-align:center;background: radial-gradient(ellipse at center, rgba(255,255,255,1) 0%,rgba(242,243,252,1) 38%,rgba(196,210,242,1) 100%);border-radius:8pt;border-width:1px;border-style:solid;border-color:#B0B0B0;box-shadow:3pt 3pt 3pt #D0D0D0">PlatformNegotiation</div></td><td style="padding-left:20pt">Protocol invocation. During this step the user should be alerted by a browser-defined dialog telling what is supposed to happen giving as well as providing an option aborting the process. In addition, the issuer <i>may</i> perform an SKS capability query.</td></tr><tr><td style="padding:0px"><div style="margin-left:auto;margin-right:auto;height:14pt;width:2pt;background-color:#909090"></div></td><td></td></tr><tr><td style="padding:0px"><div style="padding:20pt;font-size:14pt;text-align:center;background: radial-gradient(ellipse at center, rgba(255,255,255,1) 0%,rgba(242,243,252,1) 38%,rgba(196,210,242,1) 100%);border-radius:8pt;border-width:1px;border-style:solid;border-color:#B0B0B0;box-shadow:3pt 3pt 3pt #D0D0D0">ProvisioningInitialization</div></td><td style="padding-left:20pt">Creation of a <i>shared session key</i> securing the rest of the interactions between the issuer and the SKS. To support future updates of provisioned credentials, the issuer <i>may</i> also provide a <a href="#ProvisioningInitializationRequest.KeyManagementKey">KeyManagementKey</a>.</td></tr><tr><td style="padding:0px"><div style="margin-left:auto;margin-right:auto;height:14pt;width:2pt;background-color:#909090"></div></td><td></td></tr><tr><td style="padding:0px"><div style="padding:20pt;font-size:14pt;text-align:center;background: radial-gradient(ellipse at center, rgba(255,255,255,1) 0%,rgba(242,243,252,1) 38%,rgba(196,210,242,1) 100%);border-radius:8pt;border-width:1px;border-style:solid;border-color:#B0B0B0;box-shadow:3pt 3pt 3pt #D0D0D0">CredentialDiscovery</div></td><td style="padding-left:20pt"><i>Optional</i>: Issuer lookup of already provisioned SKS credentials. This is primarily used when keys need to be updated or unlocked.</td></tr><tr><td style="padding:0px"><div style="margin-left:auto;margin-right:auto;height:14pt;width:2pt;background-color:#909090"></div></td><td></td></tr><tr><td style="padding:0px"><div style="padding:20pt;font-size:14pt;text-align:center;background: radial-gradient(ellipse at center, rgba(255,255,255,1) 0%,rgba(242,243,252,1) 38%,rgba(196,210,242,1) 100%);border-radius:8pt;border-width:1px;border-style:solid;border-color:#B0B0B0;box-shadow:3pt 3pt 3pt #D0D0D0">KeyCreation</div></td><td style="padding-left:20pt">Creation of asymmetric key-pairs in the SKS. If user-defined PINs are to be set, this is carried out during <a href="#KeyCreationRequest">KeyCreationRequest</a>. After key-pairs have been created the public keys are sent to the issuer for certification.</td></tr><tr><td style="padding:0px"><div style="margin-left:auto;margin-right:auto;height:14pt;width:2pt;background-color:#909090"></div></td><td></td></tr><tr><td style="padding:0px"><div style="padding:20pt;font-size:14pt;text-align:center;background: radial-gradient(ellipse at center, rgba(255,255,255,1) 0%,rgba(242,243,252,1) 38%,rgba(196,210,242,1) 100%);border-radius:8pt;border-width:1px;border-style:solid;border-color:#B0B0B0;box-shadow:3pt 3pt 3pt #D0D0D0">ProvisioningFinalization</div></td><td style="padding-left:20pt">Deployment of credentials and associated attributes. Key&nbsp;management operations are also performed in this step. After that the session is terminated. Due to the &quot;transactional&quot; nature of SKS, <i>successful</i> session termination returns a cryptographic proof to the issuer.</td></tr><tr><td style="padding:0px"><div style="margin-left:auto;margin-right:auto;height:6pt;width:2pt;background-color:#909090"></div></td><td></td></tr><tr><td style="padding:0px"><div style="margin-left:auto;margin-right:auto;width:0pt;height:0px;border-style: solid;border-width: 8pt 4pt 0pt 4pt;border-color:#909090 transparent transparent transparent"></div></td><td></td></tr></table>Not elaborated on here is the result of the <a href="#ProvisioningFinalizationResponse">ProvisioningFinalizationResponse</a> because it is anticipated to be a custom HTML page, typically telling the user that the operation succeeded.</div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Invocation"><span style="font-size:14pt">3.1.&nbsp;Invocation</span></div>TBD</div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Error_Handling"><span style="font-size:14pt">3.2.&nbsp;Error Handling</span></div>TBD</div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Key_Management_Operations"><span style="font-size:14pt">3.3.&nbsp;Key Management Operations</span></div>TBD</div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Deferred_Issuance"><span style="font-size:14pt">3.4.&nbsp;Deferred Issuance</span></div>TBD</div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Notation"><span style="font-size:14pt">4.&nbsp;Notation</span></div>JSON objects are described as tables with associated properties. When a property holds a JSON object this is denoted by a <a href="#Notation">link</a> to the actual definition. <div style="height:6pt;padding:0px"></div>Properties may either be <i>required</i> (Y) or <i>optional</i> (O) as defined in the &quot;Req&quot; column.<div style="height:6pt;padding:0px"></div>Array properties are identified by [&thinsp;]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;x-y</span> where the range expression represents the valid number of array elements. <div style="height:6pt;padding:0px"></div>In some JSON objects there is a choice from a set of <i>mutually exclusive</i> alternatives.<br>This is manifested in object tables like the following:<table class="tftable" style="font-style:italic;margin-top:10pt;margin-bottom:5pt"><tr><td>Property selection 1</td><td>Type selection 1</td><td rowspan="2">Req</td><td>Comment selection 1</td></tr><tr><td>Property selection 2</td><td>Type selection 2</td><td>Comment selection 2</td></tr></table></div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Data_Types"><span style="font-size:14pt">5.&nbsp;Data Types</span></div>The table below shows how the data types used by this specification are mapped into native JSON types:</div><table class="tftable" style="margin-top:10pt"><tr><th>Type</th><th>Mapping</th><th>Description</th></tr><tr><td style="text-align:center">bool</td><td style="text-align:center"><code>true</code> or <code>false</code></td><td>Boolean</td></tr><tr><td style="text-align:center">short</td><td style="text-align:center"><i>number</i></td><td>Unsigned two-byte integer</td></tr><tr><td style="text-align:center">int</td><td style="text-align:center"><i>number</i></td><td>Unsigned four-byte integer</td></tr><tr><td style="text-align:center">bigint</td><td style="text-align:center"><i>number</i></td><td>Big integer</td></tr><tr><td style="text-align:center">string</td><td style="text-align:center"><i>string</i></td><td>Arbitrary string</td></tr><tr><td style="text-align:center">uri</td><td style="text-align:center"><i>string</i></td><td>URI <a href="#Reference.RFC3986">[RFC3986]</a></td></tr><tr><td style="text-align:center">id</td><td style="text-align:center"><i>string</i></td><td>Identifier which <b>must</b> consist of 1-32 characters, where each character is in the range <code>'!'</code> - <code>'~'</code> (0x21 - 0x7e).</td></tr><tr><td style="text-align:center">base64</td><td style="text-align:center"><i>string</i></td><td>Base64URL-encoded <a href="#Reference.RFC4648">[RFC4648]</a> binary data</td></tr><tr><td style="text-align:center">crypto</td><td style="text-align:center"><i>string</i></td><td>Base64URL-encoded large positive integer. Functionally equivalent to XML DSig's <a href="#Reference.XMLDSIG">[XMLDSIG]</a> <code>ds:CryptoBinary</code></td></tr><tr><td style="text-align:center">date</td><td style="text-align:center"><i>string</i></td><td>ISO date-time <code>YYYY-MM-DDThh:mm:ss{timezone}</code>.</td></tr><tr><td style="text-align:center">object</td><td style="text-align:center"><code>{}</code></td><td>JSON object</td></tr></table><div>Note that &quot;Type&quot; refers to the element type for arrays.<div style="height:6pt;padding:0px"></div></div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="KeyGen2_Objects"><span style="font-size:14pt">6.&nbsp;KeyGen2 Objects</span></div>The following tables describe the KeyGen2 JSON structures in detail.</div><table class="tftable" style="width:1000pt"><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="PlatformNegotiationRequest">PlatformNegotiationRequest</span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="PlatformNegotiationRequest.context"><code>&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20131201</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td>KeyGen2 name space/version indicator.</td></tr><tr><td style="white-space:nowrap" id="PlatformNegotiationRequest.qualifier"><code>&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">PlatformNegotiationRequest</span>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td>Actual KeyGen2 message type.</td></tr><tr><td style="white-space:nowrap" id="PlatformNegotiationRequest.ServerSessionID"><code>&quot;<span style="color:#C00000">ServerSessionID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ServerSessionID</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">Y</td><td>The <code>ServerSessionID</code> <b>must</b> remain constant for the entire session.</td></tr><tr><td style="white-space:nowrap" id="PlatformNegotiationRequest.SubmitURL"><code>&quot;<span style="color:#C00000">SubmitURL</span>&quot;:&nbsp;</code><code>&quot;</code><i>SubmitURL</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td>Where to POST the response.</td></tr><tr><td style="white-space:nowrap" id="PlatformNegotiationRequest.Action"><code>&quot;<span style="color:#C00000">Action</span>&quot;:&nbsp;</code><code>&quot;</code><i>Action</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td>The <code>Action</code> property gives (through a suitable GUI dialog) the user a hint of what the session in progress is about to perform. The valid constants are:<ul><li><code>manage</code> - Create, delete and/or update credentials</li><li style="padding-bottom:4pt;padding-top:4pt"><code>resume</code> - Resume operation after an interrupted <a href="#KeyCreationResponse">KeyCreationResponse</a>.  See <a href="#KeyCreationRequest.DeferredIssuance">DeferredIssuance</a>. A confirming client should after this call only accept a <a href="#ProvisioningFinalizationRequest">ProvisioningFinalizationRequest</a></li><li><code>unlock</code> - Unlock existing keys. A conforming client should disallow <a href="#KeyCreationRequest">KeyCreationRequest</a></li></ul></td></tr><tr><td style="white-space:nowrap" id="PlatformNegotiationRequest.AbortURL"><code>&quot;<span style="color:#C00000">AbortURL</span>&quot;:&nbsp;</code><code>&quot;</code><i>AbortURL</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">O</td><td>Optional URL the provisioning client should launch the browser with if the user cancels the process.</td></tr><tr><td style="white-space:nowrap" id="PlatformNegotiationRequest.PrivacyEnabled"><code>&quot;<span style="color:#C00000">PrivacyEnabled</span>&quot;:&nbsp;</code><code>&quot;</code><i>PrivacyEnabled</i><code>&quot;</code></td><td style="text-align:center">bool</td><td style="text-align:center">O</td><td>The <code>PrivacyEnabled</code> flag serves two purposes:<ul><li>Give the user a chance to cancel the provisioning operation if the privacy implications of the standard mode are unacceptable.<br>See SKS &quot;Privacy Enabled Mode&quot;.</li><li style="padding-top:4pt">Activate the correct mode during <a href="#ProvisioningInitializationRequest">ProvisioningInitializationRequest</a>.<br>See <code>SKS:createProvisioningSession.PrivacyEnabled</code>.</li></ul>Note: The default value is <code>false</code>.</td></tr><tr><td style="white-space:nowrap" id="PlatformNegotiationRequest.PreferredLanguages"><code>&quot;<span style="color:#C00000">PreferredLanguages</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>PreferredLanguages</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td><i>Optional</i>: List of preferred languages using ISO 639-1 two-character notation.</td></tr><tr><td style="white-space:nowrap" id="PlatformNegotiationRequest.TargetKeyContainers"><code>&quot;<span style="color:#C00000">TargetKeyContainers</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>TargetKeyContainers</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td><i>Optional</i>: List of target key container types.  The elements may be:<ul><li><code>software</code> - Software protected key container</li><li style="padding-top:4pt"><code>embedded</code> - Hardware protected embedded key container</li><li style="padding-top:4pt"><code>uicc</code> - UICC/SIM card</li><li style="padding-top:4pt"><code>sdcard</code> - SD card</li><li style="padding-top:4pt"><code>external</code> - External/connected key container</li></ul>The key containers are listed in preference order. If no matching container is available the client may prompt the user for inserting a card or similar.<div style="height:6pt;padding:0px"></div>If <code>TargetKeyContainers</code> is undefined the provisioning client is supposed to use the system's 'native' keystore.</td></tr><tr><td style="white-space:nowrap" id="PlatformNegotiationRequest.AlgorithmSupportQuery"><code>&quot;<span style="color:#C00000">AlgorithmSupportQuery</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>List of URIs</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">uri</td><td style="text-align:center">O</td><td>Query the client for support for non-mandatory algorithms.  See SKS &quot;Algorithm Support&quot;.</td></tr><tr><td style="white-space:nowrap" id="PlatformNegotiationRequest.ExtensionSupportQuery"><code>&quot;<span style="color:#C00000">ExtensionSupportQuery</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>List of URIs</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">uri</td><td style="text-align:center">O</td><td>Query the client for support for specific extension objects.<div style="height:6pt;padding:0px"></div>Note that extensions may refer to <code>SKS:addExtension</code> as well as to non-SKS items such as <a href="#ProvisioningInitializationRequest.VirtualMachine">VirtualMachine</a>.<div style="height:6pt;padding:0px"></div>Another possible use of this feature is for signaling support for extensions in the protocol itself while keeping the name-space etc. intact.</td></tr><tr><td style="white-space:nowrap" id="PlatformNegotiationRequest.ClientAttributeSupportQuery"><code>&quot;<span style="color:#C00000">ClientAttributeSupportQuery</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>List of URIs</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">uri</td><td style="text-align:center">O</td><td>Query the client for support for client attributes like IMEI number. If the client has support for such attributes it should request the user's permission to disclose them.<div style="height:6pt;padding:0px"></div>This property is not allowed in the <code>PrivacyEnabled</code> mode.<div style="height:6pt;padding:0px"></div>The following client attribute URIs are pre-defined:<ul><li><code>http://xmlns.webpki.org/keygen2/clientattr#imei-number</code></li><li><code>http://xmlns.webpki.org/keygen2/clientattr#ip-address</code></li><li><code>http://xmlns.webpki.org/keygen2/clientattr#mac-address</code></li><li><code>http://xmlns.webpki.org/keygen2/clientattr#os-vendor</code></li><li><code>http://xmlns.webpki.org/keygen2/clientattr#os-version</code></li></ul></td></tr><tr><td style="white-space:nowrap" id="PlatformNegotiationRequest.Signature"><code>&quot;<span style="color:#C00000">Signature</span>&quot;:&nbsp;</code><a href="#Signature">Signature</a></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional</i> X509-based signature covering the request. See <a href="#KeyInfo">KeyInfo</a>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="PlatformNegotiationResponse">PlatformNegotiationResponse</span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="PlatformNegotiationResponse.context"><code>&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20131201</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td>KeyGen2 name space/version indicator.</td></tr><tr><td style="white-space:nowrap" id="PlatformNegotiationResponse.qualifier"><code>&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">PlatformNegotiationResponse</span>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td>Actual KeyGen2 message type.</td></tr><tr><td style="white-space:nowrap" id="PlatformNegotiationResponse.ServerSessionID"><code>&quot;<span style="color:#C00000">ServerSessionID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ServerSessionID</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td>Copy of <code>ServerSessionID</code> from <a href="#PlatformNegotiationRequest">PlatformNegotiationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="PlatformNegotiationResponse.Nonce"><code>&quot;<span style="color:#C00000">Nonce</span>&quot;:&nbsp;</code><code>&quot;</code><i>Nonce</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">O</td><td><i>Optional</i> 1-32 byte nonce. See <a href="#ProvisioningInitializationRequest">ProvisioningInitializationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="PlatformNegotiationResponse.SupportedAlgorithms"><code>&quot;<span style="color:#C00000">SupportedAlgorithms</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>List of URIs</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">uri</td><td style="text-align:center">O</td><td>The result from <code>AlgorithmSupportQuery</code>.  If there are no matches, this property must not be present.</td></tr><tr><td style="white-space:nowrap" id="PlatformNegotiationResponse.SupportedExtensions"><code>&quot;<span style="color:#C00000">SupportedExtensions</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>List of URIs</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">uri</td><td style="text-align:center">O</td><td>The result from <code>ExtensionSupportQuery</code>.  If there are no matches, this property must not be present.</td></tr><tr><td style="white-space:nowrap" id="PlatformNegotiationResponse.SupportedClientAttributes"><code>&quot;<span style="color:#C00000">SupportedClientAttributes</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>List of URIs</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">uri</td><td style="text-align:center">O</td><td>The result from <code>ClientAttributeSupportQuery</code>.  If there are no matches, this property must not be present.</td></tr><tr><td style="white-space:nowrap" id="PlatformNegotiationResponse.ImagePreferences"><code>&quot;<span style="color:#C00000">ImagePreferences</span>&quot;:&nbsp;</code>[<a href="#ImagePreferences" style="margin-left:2pt;margin-right:2pt;">ImagePreferences</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td>List of client image preferences that the server may use for creating suitable <a href="#Logotypes">Logotypes</a>.  Known logotypes include:<ul><li><code>http://xmlns.webpki.org/keygen2/logotype#list</code><br>This type is meant to be used in credential lists and management dialogs where you could use a logotype together with a &quot;friendly name&quot; string or similar.</li><li style="padding-top:4pt"><code>http://xmlns.webpki.org/keygen2/logotype#card</code><br>A shape designed for wallet-like applications where logotypes usually are personalized.</li><li style="padding-top:4pt"><code>http://xmlns.webpki.org/keygen2/logotype#icon</code><br>Intended for selection windows holding large collections of credentials featured as maps or lists of <i>small</i> icons.</li><li style="padding-top:4pt"><code>http://xmlns.webpki.org/keygen2/logotype#application</code><br>Could be used in applications where a logotype is useful for branding/recognition purposes like in OTP systems.</li></ul>Logotypes should not have framing borders or extra margins unless these are integral parts of the actual logotype image. Logotypes should render nicely on light backgrounds. Shadows should be avoided since the icon viewer itself may add such. Support for PNG files is <i>mandatory</i>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="ProvisioningInitializationRequest">ProvisioningInitializationRequest</span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.context"><code>&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20131201</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td>KeyGen2 name space/version indicator.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.qualifier"><code>&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">ProvisioningInitializationRequest</span>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td>Actual KeyGen2 message type.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.ServerSessionID"><code>&quot;<span style="color:#C00000">ServerSessionID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ServerSessionID</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">Y</td><td>See <code>SKS:createProvisioningSession.ServerSessionID</code> and <a href="#PlatformNegotiationRequest">PlatformNegotiationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.SubmitURL"><code>&quot;<span style="color:#C00000">SubmitURL</span>&quot;:&nbsp;</code><code>&quot;</code><i>SubmitURL</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td>Where to POST the response.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.ServerTime"><code>&quot;<span style="color:#C00000">ServerTime</span>&quot;:&nbsp;</code><code>&quot;</code><i>ServerTime</i><code>&quot;</code></td><td style="text-align:center">date</td><td style="text-align:center">Y</td><td>Server time which the client should verify as a &quot;sanity&quot; check.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.SessionKeyAlgorithm"><code>&quot;<span style="color:#C00000">SessionKeyAlgorithm</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/sks/algorithm#session.1</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td>See <code>SKS:createProvisioningSession.SessionKeyAlgorithm</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.SessionKeyLimit"><code>&quot;<span style="color:#C00000">SessionKeyLimit</span>&quot;:&nbsp;</code><i>SessionKeyLimit</i></td><td style="text-align:center">short</td><td style="text-align:center">Y</td><td>See <code>SKS:createProvisioningSession.SessionKeyLimit</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.SessionLifeTime"><code>&quot;<span style="color:#C00000">SessionLifeTime</span>&quot;:&nbsp;</code><i>SessionLifeTime</i></td><td style="text-align:center">int</td><td style="text-align:center">Y</td><td>See <code>SKS:createProvisioningSession.SessionLifeTime</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.ServerEphemeralKey"><code>&quot;<span style="color:#C00000">ServerEphemeralKey</span>&quot;:&nbsp;</code><a href="#ServerEphemeralKey">ServerEphemeralKey</a></td><td style="text-align:center">object</td><td style="text-align:center">Y</td><td>See <code>SKS:createProvisioningSession.ServerEphemeralKey</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.KeyManagementKey"><code>&quot;<span style="color:#C00000">KeyManagementKey</span>&quot;:&nbsp;</code><a href="#KeyManagementKey">KeyManagementKey</a></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td>See <code>SKS:createProvisioningSession.KeyManagementKey</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.RequestedClientAttributes"><code>&quot;<span style="color:#C00000">RequestedClientAttributes</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>List of URIs</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">uri</td><td style="text-align:center">O</td><td><i>Optional</i>: List of client attribute types (expressed as URI strings) that the client <i>may</i> honor. See <a href="#ProvisioningInitializationResponse">ProvisioningInitializationResponse</a>.<div style="height:6pt;padding:0px"></div>Note that it is an <i>error</i> requesting an attribute not specified during <a href="#PlatformNegotiationRequest">PlatformNegotiationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.VirtualMachine"><code>&quot;<span style="color:#C00000">VirtualMachine</span>&quot;:&nbsp;</code><a href="#VirtualMachine">VirtualMachine</a></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td>The <code>VirtualMachine</code> option is intended to support BYOD use-cases where the provisioning process bootstraps an alternative environment and associated policies.<div style="height:6pt;padding:0px"></div>Since the exact nature of such an environment is platform-dependent, it is necessary to find out what is actually available using the pre-defined extension URI <code>&quot;http://xmlns.webpki.org/keygen2/feature#vm&quot;</code>. The recommended method is adding the following to <a href="#PlatformNegotiationRequest">PlatformNegotiationRequest</a><div style="height:6pt;padding:0px"></div><code>&nbsp;&nbsp;&quot;ExtensionSupportQuery&quot;:<br>&nbsp;&nbsp;&nbsp;&nbsp;[<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;http://xmlns.webpki.org/keygen2/feature#vm&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;http://extreme-vm.com/type.3&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;http://cool-but-obscure-vm.com/x&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;]</code><div style="height:6pt;padding:0px"></div>where the two latter URIs represent different, potentially supported environment types.<div style="height:6pt;padding:0px"></div>A possible <a href="#PlatformNegotiationResponse">PlatformNegotiationResponse</a> could be:<div style="height:6pt;padding:0px"></div><code>&nbsp;&nbsp;&quot;SupportedExtensions&quot;:<br>&nbsp;&nbsp;&nbsp;&nbsp;[<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;http://xmlns.webpki.org/keygen2/feature#vm&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;http://extreme-vm.com/type.3&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;]</code><div style="height:6pt;padding:0px"></div>If an environment is already installed only the configuration should be updated. <div style="height:6pt;padding:0px"></div>Note that the <code>VirtualMachine</code> option presumes that the <code>ProvisioningInitializationRequest</code> is <i>signed</i>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.Nonce"><code>&quot;<span style="color:#C00000">Nonce</span>&quot;:&nbsp;</code><code>&quot;</code><i>Nonce</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">O</td><td><i>Optional</i> 1-32 byte nonce. The <code>Nonce</code> value <b>must</b> be identical to the <code>Nonce</code> specified in <a href="#PlatformNegotiationResponse">PlatformNegotiationResponse</a>. Also see <code>Signature</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.Signature"><code>&quot;<span style="color:#C00000">Signature</span>&quot;:&nbsp;</code><a href="#Signature">Signature</a></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional</i> X509-based signature covering the request. See <a href="#KeyInfo">KeyInfo</a>. Note that <code>Nonce</code> <b>must</b> be specified for a signed <code>ProvisioningInitializationRequest</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="ProvisioningInitializationResponse">ProvisioningInitializationResponse</span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationResponse.context"><code>&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20131201</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td>KeyGen2 name space/version indicator.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationResponse.qualifier"><code>&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">ProvisioningInitializationResponse</span>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td>Actual KeyGen2 message type.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationResponse.ServerSessionID"><code>&quot;<span style="color:#C00000">ServerSessionID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ServerSessionID</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">Y</td><td>See <code>SKS:createProvisioningSession.ServerSessionID</code> and <a href="#PlatformNegotiationRequest">PlatformNegotiationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationResponse.ClientSessionID"><code>&quot;<span style="color:#C00000">ClientSessionID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ClientSessionID</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">Y</td><td>See <code>SKS:createProvisioningSession.ClientSessionID</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationResponse.ServerTime"><code>&quot;<span style="color:#C00000">ServerTime</span>&quot;:&nbsp;</code><code>&quot;</code><i>ServerTime</i><code>&quot;</code></td><td style="text-align:center">date</td><td style="text-align:center">Y</td><td>Server time transferred verbatim from <a href="#ProvisioningInitializationRequest">ProvisioningInitializationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationResponse.ClientTime"><code>&quot;<span style="color:#C00000">ClientTime</span>&quot;:&nbsp;</code><code>&quot;</code><i>ClientTime</i><code>&quot;</code></td><td style="text-align:center">date</td><td style="text-align:center">Y</td><td>See <code>SKS:createProvisioningSession.ClientTime</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationResponse.SessionAttestation"><code>&quot;<span style="color:#C00000">SessionAttestation</span>&quot;:&nbsp;</code><code>&quot;</code><i>SessionAttestation</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td>See <code>SKS:createProvisioningSession.SessionAttestation</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationResponse.ClientEphemeralKey"><code>&quot;<span style="color:#C00000">ClientEphemeralKey</span>&quot;:&nbsp;</code><a href="#ClientEphemeralKey">ClientEphemeralKey</a></td><td style="text-align:center">object</td><td style="text-align:center">Y</td><td>See <code>SKS:createProvisioningSession.ClientEphemeralKey</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationResponse.DeviceCertificate"><code>&quot;<span style="color:#C00000">DeviceCertificate</span>&quot;:&nbsp;</code><a href="#DeviceCertificate">DeviceCertificate</a></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td>See <code>SKS:createProvisioningSession</code>. Note that this property is either required or forbidden depending on the value of <a href="#PlatformNegotiationRequest.PrivacyEnabled">PrivacyEnabled</a>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationResponse.ServerCertificateFingerPrint"><code>&quot;<span style="color:#C00000">ServerCertificateFingerPrint</span>&quot;:&nbsp;</code><code>&quot;</code><i>ServerCertificateFingerPrint</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">O</td><td>SHA256 fingerprint of the server's certificate during receival of the <a href="#ProvisioningInitializationRequest">ProvisioningInitializationRequest</a> object. <div style="height:6pt;padding:0px"></div>This property is mandatory for HTTPS connections.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationResponse.ClientAttributes"><code>&quot;<span style="color:#C00000">ClientAttributes</span>&quot;:&nbsp;</code>[<a href="#ClientAttributes" style="margin-left:2pt;margin-right:2pt;">ClientAttributes</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional</i>: List of client attribute types and values. See <a href="#ProvisioningInitializationRequest">ProvisioningInitializationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationResponse.Signature"><code>&quot;<span style="color:#C00000">Signature</span>&quot;:&nbsp;</code><a href="#Signature">Signature</a></td><td style="text-align:center">object</td><td style="text-align:center">Y</td><td>Symmetric key signature covering the entire response. See <code>SKS:createProvisioningSession</code>.<div style="height:6pt;padding:0px"></div>Note that the value of <a href="#KeyInfo.KeyID">KeyID</a> property is <i>ignored</i>. </td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="CredentialDiscoveryRequest">CredentialDiscoveryRequest</span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="CredentialDiscoveryRequest.context"><code>&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20131201</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td>KeyGen2 name space/version indicator.</td></tr><tr><td style="white-space:nowrap" id="CredentialDiscoveryRequest.qualifier"><code>&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">CredentialDiscoveryRequest</span>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td>Actual KeyGen2 message type.</td></tr><tr><td style="white-space:nowrap" id="CredentialDiscoveryRequest.ServerSessionID"><code>&quot;<span style="color:#C00000">ServerSessionID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ServerSessionID</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">Y</td><td>See <code>SKS:createProvisioningSession.ServerSessionID</code> and <a href="#PlatformNegotiationRequest">PlatformNegotiationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="CredentialDiscoveryRequest.ClientSessionID"><code>&quot;<span style="color:#C00000">ClientSessionID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ClientSessionID</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">Y</td><td>See <code>SKS:createProvisioningSession.ClientSessionID</code>.</td></tr><tr><td style="white-space:nowrap" id="CredentialDiscoveryRequest.SubmitURL"><code>&quot;<span style="color:#C00000">SubmitURL</span>&quot;:&nbsp;</code><code>&quot;</code><i>SubmitURL</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td>Where to POST the response.</td></tr><tr><td style="white-space:nowrap" id="CredentialDiscoveryRequest.LookupSpecifiers"><code>&quot;<span style="color:#C00000">LookupSpecifiers</span>&quot;:&nbsp;</code>[<a href="#LookupSpecifiers" style="margin-left:2pt;margin-right:2pt;">LookupSpecifiers</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">Y</td><td>List of signed credential lookup specifiers. See SKS appendix &quot;Remote Key Lookup&quot; for details.</td></tr><tr><td style="white-space:nowrap" id="CredentialDiscoveryRequest.Signature"><code>&quot;<span style="color:#C00000">Signature</span>&quot;:&nbsp;</code><a href="#Signature">Signature</a></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional</i> X509-based signature covering the request. See <a href="#KeyInfo">KeyInfo</a>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="CredentialDiscoveryResponse">CredentialDiscoveryResponse</span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="CredentialDiscoveryResponse.context"><code>&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20131201</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td>KeyGen2 name space/version indicator.</td></tr><tr><td style="white-space:nowrap" id="CredentialDiscoveryResponse.qualifier"><code>&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">CredentialDiscoveryResponse</span>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td>Actual KeyGen2 message type.</td></tr><tr><td style="white-space:nowrap" id="CredentialDiscoveryResponse.ServerSessionID"><code>&quot;<span style="color:#C00000">ServerSessionID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ServerSessionID</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">Y</td><td>See <code>SKS:createProvisioningSession.ServerSessionID</code> and <a href="#PlatformNegotiationRequest">PlatformNegotiationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="CredentialDiscoveryResponse.ClientSessionID"><code>&quot;<span style="color:#C00000">ClientSessionID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ClientSessionID</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">Y</td><td>See <code>SKS:createProvisioningSession.ClientSessionID</code>.</td></tr><tr><td style="white-space:nowrap" id="CredentialDiscoveryResponse.LookupResults"><code>&quot;<span style="color:#C00000">LookupResults</span>&quot;:&nbsp;</code>[<a href="#LookupResults" style="margin-left:2pt;margin-right:2pt;">LookupResults</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">Y</td><td>List of credential lookup results. See SKS appendix &quot;Remote Key Lookup&quot; for details.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="KeyCreationRequest">KeyCreationRequest</span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="KeyCreationRequest.context"><code>&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20131201</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td>KeyGen2 name space/version indicator.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationRequest.qualifier"><code>&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">KeyCreationRequest</span>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td>Actual KeyGen2 message type.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationRequest.ServerSessionID"><code>&quot;<span style="color:#C00000">ServerSessionID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ServerSessionID</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">Y</td><td>See <code>SKS:createProvisioningSession.ServerSessionID</code> and <a href="#PlatformNegotiationRequest">PlatformNegotiationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationRequest.ClientSessionID"><code>&quot;<span style="color:#C00000">ClientSessionID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ClientSessionID</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">Y</td><td>See <code>SKS:createProvisioningSession.ClientSessionID</code>.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationRequest.SubmitURL"><code>&quot;<span style="color:#C00000">SubmitURL</span>&quot;:&nbsp;</code><code>&quot;</code><i>SubmitURL</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td>Where to POST the response.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationRequest.KeyEntryAlgorithm"><code>&quot;<span style="color:#C00000">KeyEntryAlgorithm</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/sks/algorithm#key.1</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td>See <code>SKS:createKeyEntry.KeyEntryAlgorithm</code>.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationRequest.DeferredIssuance"><code>&quot;<span style="color:#C00000">DeferredIssuance</span>&quot;:&nbsp;</code><i>DeferredIssuance</i></td><td style="text-align:center">bool</td><td style="text-align:center">O</td><td>Flag telling if the process should be suspended after <a href="#KeyCreationResponse">KeyCreationResponse</a>.  Default value: <code>false</code>. See the <code>Action</code> property in <a href="#PlatformNegotiationRequest">PlatformNegotiationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationRequest.PUKPolicySpecifiers"><code>&quot;<span style="color:#C00000">PUKPolicySpecifiers</span>&quot;:&nbsp;</code>[<a href="#PUKPolicySpecifiers" style="margin-left:2pt;margin-right:2pt;">PUKPolicySpecifiers</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td>List of PUK policy objects to be created. See <code>SKS:createPUKPolicy</code>.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationRequest.PINPolicySpecifiers"><code>&quot;<span style="color:#C00000">PINPolicySpecifiers</span>&quot;:&nbsp;</code>[<a href="#PINPolicySpecifiers" style="margin-left:2pt;margin-right:2pt;">PINPolicySpecifiers</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td>List of PIN policy objects to be created. See <code>SKS:createPINPolicy</code>.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationRequest.KeyEntrySpecifiers"><code>&quot;<span style="color:#C00000">KeyEntrySpecifiers</span>&quot;:&nbsp;</code>[<a href="#KeyEntrySpecifiers" style="margin-left:2pt;margin-right:2pt;">KeyEntrySpecifiers</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td>List of key entries to be created. See <code>SKS:createKeyEntry</code>.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationRequest.Signature"><code>&quot;<span style="color:#C00000">Signature</span>&quot;:&nbsp;</code><a href="#Signature">Signature</a></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional</i> X509-based signature covering the request. See <a href="#KeyInfo">KeyInfo</a>.</td></tr><tr><td colspan="4" style="background-color:white;border-width:0px;padding:10pt 0pt 0pt 0pt">Due to the stateful MAC-scheme featured in SKS, the properties beginning with <code>PUKPolicySpecifiers</code> and ending with <code>KeyEntrySpecifiers</code>, <b>must</b> <i>be generated (by the issuer) and executed (by the SKS) in exactly the order they are declared in this table as well as in associated object arrays</i>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="KeyCreationResponse">KeyCreationResponse</span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="KeyCreationResponse.context"><code>&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20131201</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td>KeyGen2 name space/version indicator.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationResponse.qualifier"><code>&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">KeyCreationResponse</span>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td>Actual KeyGen2 message type.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationResponse.ServerSessionID"><code>&quot;<span style="color:#C00000">ServerSessionID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ServerSessionID</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">Y</td><td>See <code>SKS:createProvisioningSession.ServerSessionID</code> and <a href="#PlatformNegotiationRequest">PlatformNegotiationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationResponse.ClientSessionID"><code>&quot;<span style="color:#C00000">ClientSessionID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ClientSessionID</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">Y</td><td>See <code>SKS:createProvisioningSession.ClientSessionID</code>.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationResponse.GeneratedKeys"><code>&quot;<span style="color:#C00000">GeneratedKeys</span>&quot;:&nbsp;</code>[<a href="#GeneratedKeys" style="margin-left:2pt;margin-right:2pt;">GeneratedKeys</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">Y</td><td>List of generated keys. See <code>SKS:createKeyEntry</code>.</td></tr><tr><td colspan="4" style="background-color:white;border-width:0px;padding:10pt 0pt 0pt 0pt">Due to the stateful MAC-scheme featured in SKS, <code>GeneratedKeys</code> <b>must</b> <i>be generated (by the SKS) and decoded (by the issuer) in exactly the same order (message-wise) as they are encountered in the associated</i>  <a href="#KeyCreationRequest.KeyEntrySpecifiers">KeyEntrySpecifiers</a> (including those embedded by <a href="#KeyCreationRequest.PINPolicySpecifiers">PINPolicySpecifiers</a>).</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="ProvisioningFinalizationRequest">ProvisioningFinalizationRequest</span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationRequest.context"><code>&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20131201</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td>KeyGen2 name space/version indicator.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationRequest.qualifier"><code>&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">ProvisioningFinalizationRequest</span>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td>Actual KeyGen2 message type.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationRequest.ServerSessionID"><code>&quot;<span style="color:#C00000">ServerSessionID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ServerSessionID</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">Y</td><td>See <code>SKS:createProvisioningSession.ServerSessionID</code> and <a href="#PlatformNegotiationRequest">PlatformNegotiationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationRequest.ClientSessionID"><code>&quot;<span style="color:#C00000">ClientSessionID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ClientSessionID</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">Y</td><td>See <code>SKS:createProvisioningSession.ClientSessionID</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationRequest.SubmitURL"><code>&quot;<span style="color:#C00000">SubmitURL</span>&quot;:&nbsp;</code><code>&quot;</code><i>SubmitURL</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td>Where to POST the response.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationRequest.IssuedCredentials"><code>&quot;<span style="color:#C00000">IssuedCredentials</span>&quot;:&nbsp;</code>[<a href="#IssuedCredentials" style="margin-left:2pt;margin-right:2pt;">IssuedCredentials</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional:</i> List of issued credentials. See <code>SKS:setCertificatePath</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationRequest.UnlockKeys"><code>&quot;<span style="color:#C00000">UnlockKeys</span>&quot;:&nbsp;</code>[<a href="#UnlockKeys" style="margin-left:2pt;margin-right:2pt;">UnlockKeys</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional:</i> List of keys to be unlocked. See <code>SKS:postUnlockKey</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationRequest.DeleteKeys"><code>&quot;<span style="color:#C00000">DeleteKeys</span>&quot;:&nbsp;</code>[<a href="#DeleteKeys" style="margin-left:2pt;margin-right:2pt;">DeleteKeys</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional:</i> List of keys to be deleted. See <code>SKS:postDeleteKey</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationRequest.Challenge"><code>&quot;<span style="color:#C00000">Challenge</span>&quot;:&nbsp;</code><code>&quot;</code><i>Challenge</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td>See <code>SKS:closeProvisioningSession</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationRequest.MAC"><code>&quot;<span style="color:#C00000">MAC</span>&quot;:&nbsp;</code><code>&quot;</code><i>MAC</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td>Caller authentication. See <code>SKS:closeProvisioningSession.MAC</code>.<div style="height:6pt;padding:0px"></div>Due to the stateful MAC-scheme featured in SKS, this <code>MAC</code> <b>must</b> be the final of a provisioning session both during encoding and decoding.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationRequest.Signature"><code>&quot;<span style="color:#C00000">Signature</span>&quot;:&nbsp;</code><a href="#Signature">Signature</a></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional</i> X509-based signature covering the request. See <a href="#KeyInfo">KeyInfo</a>.</td></tr><tr><td colspan="4" style="background-color:white;border-width:0px;padding:10pt 0pt 0pt 0pt">Due to the stateful MAC-scheme featured in SKS, the properties beginning with <code>IssuedCredentials</code> and ending with <code>DeleteKeys</code>, <b>must</b> <i>be generated (by the issuer) and executed (by the SKS) in exactly the order they are declared in this table as well as in associated object arrays</i>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="ProvisioningFinalizationResponse">ProvisioningFinalizationResponse</span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationResponse.context"><code>&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20131201</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td>KeyGen2 name space/version indicator.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationResponse.qualifier"><code>&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">ProvisioningFinalizationResponse</span>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td>Actual KeyGen2 message type.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationResponse.ServerSessionID"><code>&quot;<span style="color:#C00000">ServerSessionID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ServerSessionID</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">Y</td><td>See <code>SKS:createProvisioningSession.ServerSessionID</code> and <a href="#PlatformNegotiationRequest">PlatformNegotiationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationResponse.ClientSessionID"><code>&quot;<span style="color:#C00000">ClientSessionID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ClientSessionID</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">Y</td><td>See <code>SKS:createProvisioningSession.ClientSessionID</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationResponse.CloseAttestation"><code>&quot;<span style="color:#C00000">CloseAttestation</span>&quot;:&nbsp;</code><code>&quot;</code><i>CloseAttestation</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td>See <code>SKS:closeProvisioningSession</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="KeyManagementKey"><i>KeyManagementKey</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="KeyManagementKey.PublicKey"><code>&quot;<span style="color:#C00000">PublicKey</span>&quot;:&nbsp;</code><a href="#PublicKey">PublicKey</a></td><td style="text-align:center">object</td><td style="text-align:center">Y</td><td>Actual key management key.</td></tr><tr><td style="white-space:nowrap" id="KeyManagementKey.UpdatableKeyManagementKeys"><code>&quot;<span style="color:#C00000">UpdatableKeyManagementKeys</span>&quot;:&nbsp;</code>[<a href="#UpdatableKeyManagementKeys" style="margin-left:2pt;margin-right:2pt;">UpdatableKeyManagementKeys</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional:</i> List of the previous generation of key management keys.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="UpdatableKeyManagementKeys"><i>UpdatableKeyManagementKeys</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="UpdatableKeyManagementKeys.PublicKey"><code>&quot;<span style="color:#C00000">PublicKey</span>&quot;:&nbsp;</code><a href="#PublicKey">PublicKey</a></td><td style="text-align:center">object</td><td style="text-align:center">Y</td><td>Previous generation key management key.<div style="height:6pt;padding:0px"></div>Note that <code>SKS:updateKeyManagementKey.KeyManagementKey</code> refers to the <i>new</i> key management key specified in the object <i>immediately above</i> (=embedding) this <a href="#UpdatableKeyManagementKeys">UpdatableKeyManagementKeys</a> object.</td></tr><tr><td style="white-space:nowrap" id="UpdatableKeyManagementKeys.Authorization"><code>&quot;<span style="color:#C00000">Authorization</span>&quot;:&nbsp;</code><code>&quot;</code><i>Authorization</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td>Authorization of the new key management key. See <code>SKS:updateKeyManagementKey.Authorization</code>.</td></tr><tr><td style="white-space:nowrap" id="UpdatableKeyManagementKeys.UpdatableKeyManagementKeys"><code>&quot;<span style="color:#C00000">UpdatableKeyManagementKeys</span>&quot;:&nbsp;</code>[<a href="#UpdatableKeyManagementKeys" style="margin-left:2pt;margin-right:2pt;">UpdatableKeyManagementKeys</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional:</i> List of the previous generation of key management keys.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="VirtualMachine"><i>VirtualMachine</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="VirtualMachine.Type"><code>&quot;<span style="color:#C00000">Type</span>&quot;:&nbsp;</code><code>&quot;</code><i>Type</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td>Virtual machine specific type URI like <code>&quot;http://extreme-vm.com/type.3&quot;</code>.</td></tr><tr><td style="white-space:nowrap" id="VirtualMachine.Configuration"><code>&quot;<span style="color:#C00000">Configuration</span>&quot;:&nbsp;</code><code>&quot;</code><i>Configuration</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td>Virtual machine specific configuration (setup) data.</td></tr><tr><td style="white-space:nowrap" id="VirtualMachine.FriendlyName"><code>&quot;<span style="color:#C00000">FriendlyName</span>&quot;:&nbsp;</code><code>&quot;</code><i>FriendlyName</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td>Virtual machine friendly name.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="LookupSpecifiers"><i>LookupSpecifiers</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="LookupSpecifiers.ID"><code>&quot;<span style="color:#C00000">ID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ID</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">Y</td><td>Each specifier <b>must</b> have a unique ID.</td></tr><tr><td style="white-space:nowrap" id="LookupSpecifiers.Nonce"><code>&quot;<span style="color:#C00000">Nonce</span>&quot;:&nbsp;</code><code>&quot;</code><i>Nonce</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td><code>Nonce</code> data. See SKS appendix &quot;Remote Key Lookup&quot; for details.</td></tr><tr><td style="white-space:nowrap" id="LookupSpecifiers.SearchFilter"><code>&quot;<span style="color:#C00000">SearchFilter</span>&quot;:&nbsp;</code><a href="#SearchFilter">SearchFilter</a></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional</i> additional search criterions.<div style="height:6pt;padding:0px"></div>Note that at least one search criterion <b>must</b> be specified if this option is used.</td></tr><tr><td style="white-space:nowrap" id="LookupSpecifiers.Signature"><code>&quot;<span style="color:#C00000">Signature</span>&quot;:&nbsp;</code><a href="#Signature">Signature</a></td><td style="text-align:center">object</td><td style="text-align:center">Y</td><td>Signature using a key management key signature covering the lookup specifier. See SKS appendix &quot;Remote Key Lookup&quot; for details.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="SearchFilter"><i>SearchFilter</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="SearchFilter.FingerPrint"><code>&quot;<span style="color:#C00000">FingerPrint</span>&quot;:&nbsp;</code><code>&quot;</code><i>FingerPrint</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">O</td><td>SHA256 fingerprint matching any certificate in the <i>certificate path</i>.</td></tr><tr><td style="white-space:nowrap" id="SearchFilter.IssuerRegEx"><code>&quot;<span style="color:#C00000">IssuerRegEx</span>&quot;:&nbsp;</code><code>&quot;</code><i>IssuerRegEx</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>Regular expression matching any issuer in the <i>certificate path</i>. Issuer names are assumed to be expressed in LDAP <a href="#Reference.RFC4514">[RFC4514]</a> notation.</td></tr><tr><td style="white-space:nowrap" id="SearchFilter.SerialNumber"><code>&quot;<span style="color:#C00000">SerialNumber</span>&quot;:&nbsp;</code><code>&quot;</code><i>SerialNumber</i><code>&quot;</code></td><td style="text-align:center">bigint</td><td style="text-align:center">O</td><td>Serial number matching that of the <i>end-entity certificate</i>.</td></tr><tr><td style="white-space:nowrap" id="SearchFilter.SubjectRegEx"><code>&quot;<span style="color:#C00000">SubjectRegEx</span>&quot;:&nbsp;</code><code>&quot;</code><i>SubjectRegEx</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>Regular expression matching the subject in the <i>end-entity certificate</i>. Subject names are assumed to be expressed in LDAP <a href="#Reference.RFC4514">[RFC4514]</a> notation.</td></tr><tr><td style="white-space:nowrap" id="SearchFilter.EmailRegEx"><code>&quot;<span style="color:#C00000">EmailRegEx</span>&quot;:&nbsp;</code><code>&quot;</code><i>EmailRegEx</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>Regular expression matching any of the e-mail addresses in the <i>end-entity certificate</i>.<div style="height:6pt;padding:0px"></div>Note that both RFC&nbsp;822 subject attributes and <code>subjectAltName</code> fields are in scope.</td></tr><tr><td style="white-space:nowrap" id="SearchFilter.PolicyRules"><code>&quot;<span style="color:#C00000">PolicyRules</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>PolicyRules</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>List of X.509 policy extension OIDs using the notation <code style="white-space:nowrap">&quot;1.4.3&quot;</code> and <code style="white-space:nowrap">&quot;-1.4.7&quot;</code> for a required and forbidden policy OID respectively.<div style="height:6pt;padding:0px"></div>Policy OIDs encountered in <i>end-entity certificates</i> that are not specified in <code>PolicyRules</code> <b>must</b> be <i>ignored</i>.</td></tr><tr><td style="white-space:nowrap" id="SearchFilter.KeyUsageRules"><code>&quot;<span style="color:#C00000">KeyUsageRules</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>KeyUsageRules</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>List of X.509 key usage flags using the notation <code>&quot;digitalSignature&quot;</code> and <code style="white-space:nowrap">&quot;-dataEncipherment&quot;</code> for a required and forbidden key usage respectively.<div style="height:6pt;padding:0px"></div>Key usage flags encountered in <i>end-entity certificates</i> that are not specified in <code>KeyUsageRules</code> <b>must</b> be <i>ignored</i>. <div style="height:6pt;padding:0px"></div>The set of permitted flags include:<ul><li><code>digitalSignature</code></li><li><code>nonRepudiation</code></li><li><code>keyEncipherment</code></li><li><code>dataEncipherment</code></li><li><code>keyAgreement</code></li><li><code>keyCertSign</code></li><li><code>cRLSign</code></li><li><code>encipherOnly</code></li><li><code>decipherOnly</code></li></ul></td></tr><tr><td style="white-space:nowrap" id="SearchFilter.ExtendedKeyUsageRules"><code>&quot;<span style="color:#C00000">ExtendedKeyUsageRules</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>ExtendedKeyUsageRules</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>List of X.509 extended key usage extension OIDs using the notation <code style="white-space:nowrap">&quot;1.4.3&quot;</code> and <code style="white-space:nowrap">&quot;-1.4.7&quot;</code> for a required and forbidden extended key usage respectively.<div style="height:6pt;padding:0px"></div>Extended key usage OIDs encountered in <i>end-entity certificates</i> that are not specified in <code>ExtendedKeyUsageRules</code> <b>must</b> be <i>ignored</i>.</td></tr><tr><td style="white-space:nowrap" id="SearchFilter.IssuedBefore"><code>&quot;<span style="color:#C00000">IssuedBefore</span>&quot;:&nbsp;</code><code>&quot;</code><i>IssuedBefore</i><code>&quot;</code></td><td style="text-align:center">date</td><td style="text-align:center">O</td><td>Matching <i>end-entity certificates</i> issued before this date.<div style="height:6pt;padding:0px"></div>Note that you can combine this criterion with an <code>IssuedAfter</code> criterion using an earlier date, effectively creating a time window.</td></tr><tr><td style="white-space:nowrap" id="SearchFilter.IssuedAfter"><code>&quot;<span style="color:#C00000">IssuedAfter</span>&quot;:&nbsp;</code><code>&quot;</code><i>IssuedAfter</i><code>&quot;</code></td><td style="text-align:center">date</td><td style="text-align:center">O</td><td>Matching <i>end-entity certificates</i> issued after this date.</td></tr><tr><td style="white-space:nowrap" id="SearchFilter.Grouping"><code>&quot;<span style="color:#C00000">Grouping</span>&quot;:&nbsp;</code><code>&quot;</code><i>Grouping</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>Matching keys based on the <code>SKS:createPINPolicy.Grouping</code> attribute.<div style="height:6pt;padding:0px"></div>Note that keys that are not PIN-protected <b>must</b> always fail to match.</td></tr><tr><td style="white-space:nowrap" id="SearchFilter.AppUsage"><code>&quot;<span style="color:#C00000">AppUsage</span>&quot;:&nbsp;</code><code>&quot;</code><i>AppUsage</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>Matching keys based on the <code>SKS:createKeyEntry.AppUsage</code> attribute.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="LookupResults"><i>LookupResults</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="LookupResults.ID"><code>&quot;<span style="color:#C00000">ID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ID</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">Y</td><td>Each result <b>must</b> have a unique ID matching the request.</td></tr><tr><td style="white-space:nowrap" id="LookupResults.MatchingCredentials"><code>&quot;<span style="color:#C00000">MatchingCredentials</span>&quot;:&nbsp;</code>[<a href="#MatchingCredentials" style="margin-left:2pt;margin-right:2pt;">MatchingCredentials</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;0-n</span></td><td style="text-align:center">object</td><td style="text-align:center">Y</td><td>List of matching credentials.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="MatchingCredentials"><i>MatchingCredentials</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="MatchingCredentials.ServerSessionID"><code>&quot;<span style="color:#C00000">ServerSessionID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ServerSessionID</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td><code>ServerSessionID</code> of matching credential.</td></tr><tr><td style="white-space:nowrap" id="MatchingCredentials.ClientSessionID"><code>&quot;<span style="color:#C00000">ClientSessionID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ClientSessionID</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td><code>ClientSessionID</code> of matching credential.</td></tr><tr><td style="white-space:nowrap" id="MatchingCredentials.X509CertificatePath"><code>&quot;<span style="color:#C00000">X509CertificatePath</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>Sorted Certificate Path</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td>Identical representation as the <code>X509CertificatePath</code> in <a href="#KeyInfo">KeyInfo</a>.</td></tr><tr><td style="white-space:nowrap" id="MatchingCredentials.Locked"><code>&quot;<span style="color:#C00000">Locked</span>&quot;:&nbsp;</code><i>Locked</i></td><td style="text-align:center">bool</td><td style="text-align:center">O</td><td>If this property is <code>true</code> the key associated with the credential is locked due to multiple PIN errors. The default value is <code>false</code>.  See <a href="#ProvisioningFinalizationRequest.UnlockKeys">UnlockKeys</a>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="PUKPolicySpecifiers"><i>PUKPolicySpecifiers</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="PUKPolicySpecifiers.ID"><code>&quot;<span style="color:#C00000">ID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ID</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">Y</td><td>See <code>SKS:createPUKPolicy.ID</code>.</td></tr><tr><td style="white-space:nowrap" id="PUKPolicySpecifiers.EncryptedPUK"><code>&quot;<span style="color:#C00000">EncryptedPUK</span>&quot;:&nbsp;</code><code>&quot;</code><i>EncryptedPUK</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td>See <code>SKS:createPUKPolicy.EncryptedPUK</code>.</td></tr><tr><td style="white-space:nowrap" id="PUKPolicySpecifiers.RetryLimit"><code>&quot;<span style="color:#C00000">RetryLimit</span>&quot;:&nbsp;</code><i>RetryLimit</i></td><td style="text-align:center">short</td><td style="text-align:center">Y</td><td>See <code>SKS:createPUKPolicy.RetryLimit</code>.</td></tr><tr><td style="white-space:nowrap" id="PUKPolicySpecifiers.Format"><code>&quot;<span style="color:#C00000">Format</span>&quot;:&nbsp;</code><code>&quot;</code><i>Format</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td>See <code>SKS:createPUKPolicy.Format</code>.</td></tr><tr><td style="white-space:nowrap" id="PUKPolicySpecifiers.MAC"><code>&quot;<span style="color:#C00000">MAC</span>&quot;:&nbsp;</code><code>&quot;</code><i>MAC</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td>Caller authentication. See <code>SKS:createPUKPolicy.MAC</code>.</td></tr><tr><td style="white-space:nowrap" id="PUKPolicySpecifiers.PINPolicySpecifiers"><code>&quot;<span style="color:#C00000">PINPolicySpecifiers</span>&quot;:&nbsp;</code>[<a href="#PINPolicySpecifiers" style="margin-left:2pt;margin-right:2pt;">PINPolicySpecifiers</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">Y</td><td>List of PIN policy objects to be created and controlled by this PUK policy. See <code>SKS:createPINPolicy</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="PINPolicySpecifiers"><i>PINPolicySpecifiers</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="PINPolicySpecifiers.ID"><code>&quot;<span style="color:#C00000">ID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ID</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">Y</td><td>See <code>SKS:createPINPolicy.ID</code>.</td></tr><tr><td style="white-space:nowrap" id="PINPolicySpecifiers.MinLength"><code>&quot;<span style="color:#C00000">MinLength</span>&quot;:&nbsp;</code><i>MinLength</i></td><td style="text-align:center">short</td><td style="text-align:center">Y</td><td>See <code>SKS:createPINPolicy.MinLength</code>.</td></tr><tr><td style="white-space:nowrap" id="PINPolicySpecifiers.MaxLength"><code>&quot;<span style="color:#C00000">MaxLength</span>&quot;:&nbsp;</code><i>MaxLength</i></td><td style="text-align:center">short</td><td style="text-align:center">Y</td><td>See <code>SKS:createPINPolicy.MaxLength</code>.</td></tr><tr><td style="white-space:nowrap" id="PINPolicySpecifiers.RetryLimit"><code>&quot;<span style="color:#C00000">RetryLimit</span>&quot;:&nbsp;</code><i>RetryLimit</i></td><td style="text-align:center">short</td><td style="text-align:center">Y</td><td>See <code>SKS:createPINPolicy.RetryLimit</code>.</td></tr><tr><td style="white-space:nowrap" id="PINPolicySpecifiers.Format"><code>&quot;<span style="color:#C00000">Format</span>&quot;:&nbsp;</code><code>&quot;</code><i>Format</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td>See <code>SKS:createPINPolicy.Format</code>.</td></tr><tr><td style="white-space:nowrap" id="PINPolicySpecifiers.UserModifiable"><code>&quot;<span style="color:#C00000">UserModifiable</span>&quot;:&nbsp;</code><i>UserModifiable</i></td><td style="text-align:center">bool</td><td style="text-align:center">O</td><td>Flag with the default value <code>true</code>.<br>See <code>SKS:createPINPolicy.UserModifiable</code>.</td></tr><tr><td style="white-space:nowrap" id="PINPolicySpecifiers.Grouping"><code>&quot;<span style="color:#C00000">Grouping</span>&quot;:&nbsp;</code><code>&quot;</code><i>Grouping</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>Grouping specifier with the default value <code>none</code>.<br>See <code>SKS:createPINPolicy.Grouping</code>.</td></tr><tr><td style="white-space:nowrap" id="PINPolicySpecifiers.InputMethod"><code>&quot;<span style="color:#C00000">InputMethod</span>&quot;:&nbsp;</code><code>&quot;</code><i>InputMethod</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>Input method specifier with the default value <code>any</code>.<br>See <code>SKS:createPINPolicy.InputMethod</code>.</td></tr><tr><td style="white-space:nowrap" id="PINPolicySpecifiers.PatternRestrictions"><code>&quot;<span style="color:#C00000">PatternRestrictions</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>PatternRestrictions</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>List of pattern restrictions.  See <code>SKS:createPINPolicy.PatternRestrictions</code>.<br>If this property is undefined, there are no PIN pattern restrictions.</td></tr><tr><td style="white-space:nowrap" id="PINPolicySpecifiers.MAC"><code>&quot;<span style="color:#C00000">MAC</span>&quot;:&nbsp;</code><code>&quot;</code><i>MAC</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td>Caller authentication. See <code>SKS:createPINPolicy.MAC</code>.</td></tr><tr><td style="white-space:nowrap" id="PINPolicySpecifiers.KeyEntrySpecifiers"><code>&quot;<span style="color:#C00000">KeyEntrySpecifiers</span>&quot;:&nbsp;</code>[<a href="#KeyEntrySpecifiers" style="margin-left:2pt;margin-right:2pt;">KeyEntrySpecifiers</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">Y</td><td>List of key entries to be created and controlled by this PIN policy.<br>See <code>SKS:createKeyEntry</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="KeyEntrySpecifiers"><i>KeyEntrySpecifiers</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="KeyEntrySpecifiers.ID"><code>&quot;<span style="color:#C00000">ID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ID</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">Y</td><td>See <code>SKS:createKeyEntry.ID</code>.</td></tr><tr><td style="white-space:nowrap" id="KeyEntrySpecifiers.EncryptedPresetPIN"><code>&quot;<span style="color:#C00000">EncryptedPresetPIN</span>&quot;:&nbsp;</code><code>&quot;</code><i>EncryptedPresetPIN</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">O</td><td>See <code>SKS:createKeyEntry.PINValue</code>.<br>Note that if this property is defined, the <code>SKS:createPINPolicy.UserDefined</code> flag of the required embedding PIN policy is set to <code>false</code> else it is set to <code>true</code>.<div style="height:6pt;padding:0px"></div>Keys associated with a specific PIN policy <b>must not</b> mix user-defined and preset PINs.</td></tr><tr><td style="white-space:nowrap" id="KeyEntrySpecifiers.EnablePINCaching"><code>&quot;<span style="color:#C00000">EnablePINCaching</span>&quot;:&nbsp;</code><i>EnablePINCaching</i></td><td style="text-align:center">bool</td><td style="text-align:center">O</td><td>Flag with the default value <code>false</code>.<br>See <code>SKS:createKeyEntry.EnablePINCaching</code>.</td></tr><tr><td style="white-space:nowrap" id="KeyEntrySpecifiers.DevicePINProtection"><code>&quot;<span style="color:#C00000">DevicePINProtection</span>&quot;:&nbsp;</code><i>DevicePINProtection</i></td><td style="text-align:center">bool</td><td style="text-align:center">O</td><td>Flag with the default value <code>false</code>.<br>See <code>SKS:createKeyEntry.DevicePINProtection</code>. <div style="height:6pt;padding:0px"></div>Note that this flag (if true) cannot be combined with PIN policy settings.</td></tr><tr><td style="white-space:nowrap" id="KeyEntrySpecifiers.AppUsage"><code>&quot;<span style="color:#C00000">AppUsage</span>&quot;:&nbsp;</code><code>&quot;</code><i>AppUsage</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td>See <code>SKS:createKeyEntry.AppUsage</code>.</td></tr><tr><td style="white-space:nowrap" id="KeyEntrySpecifiers.KeyAlgorithm"><code>&quot;<span style="color:#C00000">KeyAlgorithm</span>&quot;:&nbsp;</code><code>&quot;</code><i>KeyAlgorithm</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td>See <code>SKS:createKeyEntry.KeyAlgorithm</code>. Also see SKS &quot;Algorithm Support&quot;.<div style="height:6pt;padding:0px"></div>The currently recognized key algorithms include:<ul><li><code>http://xmlns.webpki.org/sks/algorithm#rsa1024</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#rsa2048</code></li><li><code style="color:#A0A0A0">http://xmlns.webpki.org/sks/algorithm#rsa3072</code></li><li><code style="color:#A0A0A0">http://xmlns.webpki.org/sks/algorithm#rsa4096</code></li><li><code style="color:#A0A0A0">http://xmlns.webpki.org/sks/algorithm#rsa1024.exp</code></li><li><code style="color:#A0A0A0">http://xmlns.webpki.org/sks/algorithm#rsa2048.exp</code></li><li><code style="color:#A0A0A0">http://xmlns.webpki.org/sks/algorithm#rsa3072.exp</code></li><li><code style="color:#A0A0A0">http://xmlns.webpki.org/sks/algorithm#rsa4096.exp</code></li><li><code style="color:#A0A0A0">http://xmlns.webpki.org/sks/algorithm#ec.nist.b163</code></li><li><code style="color:#A0A0A0">http://xmlns.webpki.org/sks/algorithm#ec.nist.b233</code></li><li><code style="color:#A0A0A0">http://xmlns.webpki.org/sks/algorithm#ec.nist.b283</code></li><li><code style="color:#A0A0A0">http://xmlns.webpki.org/sks/algorithm#ec.nist.p192</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#ec.nist.p256</code></li><li><code style="color:#A0A0A0">http://xmlns.webpki.org/sks/algorithm#ec.nist.p384</code></li><li><code style="color:#A0A0A0">http://xmlns.webpki.org/sks/algorithm#ec.nist.p521</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#ec.brainpool.p256r1</code></li></ul></td></tr><tr><td style="white-space:nowrap" id="KeyEntrySpecifiers.KeyParameters"><code>&quot;<span style="color:#C00000">KeyParameters</span>&quot;:&nbsp;</code><code>&quot;</code><i>KeyParameters</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">O</td><td>See <code>SKS:createKeyEntry.KeyParameters</code>.</td></tr><tr><td style="white-space:nowrap" id="KeyEntrySpecifiers.EndorsedAlgorithms"><code>&quot;<span style="color:#C00000">EndorsedAlgorithms</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>List of URIs</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">uri</td><td style="text-align:center">O</td><td>See <code>SKS:createKeyEntry.EndorsedAlgorithm</code>. Also see SKS &quot;Algorithm Support&quot;.<div style="height:6pt;padding:0px"></div>Note that <i>endorsed algorithm URIs <b>must</b> be specified in strict lexical order</i>.<div style="height:6pt;padding:0px"></div>The currently recognized algorithms include:<ul><li><code>http://www.w3.org/2000/09/xmldsig#hmac-sha1</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#hmac-sha256</code></li><li><code style="color:#A0A0A0">http://www.w3.org/2001/04/xmldsig-more#hmac-sha384</code></li><li><code style="color:#A0A0A0">http://www.w3.org/2001/04/xmldsig-more#hmac-sha512</code></li></ul><ul><li><code>http://xmlns.webpki.org/sks/algorithm#rsa.pkcs1.none</code></li><li><code>http://www.w3.org/2000/09/xmldsig#rsa-sha1</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#rsa-sha256</code></li><li><code style="color:#A0A0A0">http://www.w3.org/2001/04/xmldsig-more#rsa-sha384</code></li><li><code style="color:#A0A0A0">http://www.w3.org/2001/04/xmldsig-more#rsa-sha512</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#ecdsa.none</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha1</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha256</code></li><li><code style="color:#A0A0A0">http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha384</code></li><li><code style="color:#A0A0A0">http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha512</code></li></ul><ul><li><code>http://xmlns.webpki.org/sks/algorithm#rsa.pkcs1_5</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#rsa.oaep.sha1.mgf1p</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#rsa.oaep.sha256.mgf1p</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#rsa.raw</code></li></ul><ul><li><code>http://www.w3.org/2001/04/xmlenc#aes128-cbc</code></li><li><code>http://www.w3.org/2001/04/xmlenc#aes192-cbc</code></li><li><code>http://www.w3.org/2001/04/xmlenc#aes256-cbc</code></li><li><code style="color:#A0A0A0">http://www.w3.org/2001/04/xmlenc#kw-aes128</code></li><li><code style="color:#A0A0A0">http://www.w3.org/2001/04/xmlenc#kw-aes256</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#aes.ecb.nopad</code></li><li><code style="color:#A0A0A0">http://xmlns.webpki.org/sks/algorithm#aes.ecb.pkcs5</code></li><li><code style="color:#A0A0A0">http://xmlns.webpki.org/sks/algorithm#aes.cbc.nopad</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#aes.cbc.pkcs5</code></li></ul><ul><li><code>http://xmlns.webpki.org/sks/algorithm#ecdh.raw</code></li></ul><ul><li><code>http://xmlns.webpki.org/sks/algorithm#none</code></li></ul></td></tr><tr><td style="white-space:nowrap" id="KeyEntrySpecifiers.ServerSeed"><code>&quot;<span style="color:#C00000">ServerSeed</span>&quot;:&nbsp;</code><code>&quot;</code><i>ServerSeed</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">O</td><td>See <code>SKS:createKeyEntry.ServerSeed</code>. If this property is undefined, it is assumed to be a zero-length array.</td></tr><tr><td style="white-space:nowrap" id="KeyEntrySpecifiers.BiometricProtection"><code>&quot;<span style="color:#C00000">BiometricProtection</span>&quot;:&nbsp;</code><code>&quot;</code><i>BiometricProtection</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>See <code>SKS:createKeyEntry.BiometricProtection</code>. The default value is <code>none</code>.</td></tr><tr><td style="white-space:nowrap" id="KeyEntrySpecifiers.DeleteProtection"><code>&quot;<span style="color:#C00000">DeleteProtection</span>&quot;:&nbsp;</code><code>&quot;</code><i>DeleteProtection</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>See <code>SKS:createKeyEntry.DeleteProtection</code>. The default value is <code>none</code>.</td></tr><tr><td style="white-space:nowrap" id="KeyEntrySpecifiers.ExportProtection"><code>&quot;<span style="color:#C00000">ExportProtection</span>&quot;:&nbsp;</code><code>&quot;</code><i>ExportProtection</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>See <code>SKS:createKeyEntry.ExportProtection</code>. The default value is <code style="white-space:nowrap">non-exportable</code>.</td></tr><tr><td style="white-space:nowrap" id="KeyEntrySpecifiers.FriendlyName"><code>&quot;<span style="color:#C00000">FriendlyName</span>&quot;:&nbsp;</code><code>&quot;</code><i>FriendlyName</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>See <code>SKS:createKeyEntry.FriendlyName</code>.If this property is undefined, it is assumed to be a zero-length array.</td></tr><tr><td style="white-space:nowrap" id="KeyEntrySpecifiers.MAC"><code>&quot;<span style="color:#C00000">MAC</span>&quot;:&nbsp;</code><code>&quot;</code><i>MAC</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td>Caller authentication. See <code>SKS:createKeyEntry.MAC</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="GeneratedKeys"><i>GeneratedKeys</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="GeneratedKeys.ID"><code>&quot;<span style="color:#C00000">ID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ID</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">Y</td><td><code>ID</code> <b>must</b> match the identifier used in <a href="#KeyCreationRequest">KeyCreationRequest</a> for a specific key.</td></tr><tr><td style="white-space:nowrap" id="GeneratedKeys.PublicKey"><code>&quot;<span style="color:#C00000">PublicKey</span>&quot;:&nbsp;</code><a href="#PublicKey">PublicKey</a></td><td style="text-align:center">object</td><td style="text-align:center">Y</td><td>See <code>SKS:createKeyEntry.PublicKey</code>.</td></tr><tr><td style="white-space:nowrap" id="GeneratedKeys.KeyAttestation"><code>&quot;<span style="color:#C00000">KeyAttestation</span>&quot;:&nbsp;</code><code>&quot;</code><i>KeyAttestation</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td>See <code>SKS:createKeyEntry.KeyAttestation</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="IssuedCredentials"><i>IssuedCredentials</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="IssuedCredentials.ID"><code>&quot;<span style="color:#C00000">ID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ID</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">Y</td><td>See <code>SKS:setCertificatePath.ID</code>.<br><code>ID</code> <b>must</b> match the identifier used in <a href="#KeyCreationRequest">KeyCreationRequest</a> for a specific key.</td></tr><tr><td style="white-space:nowrap" id="IssuedCredentials.X509CertificatePath"><code>&quot;<span style="color:#C00000">X509CertificatePath</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>Sorted Certificate Path</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td>See <code>SKS:setCertificatePath.X509Certificate</code>.<br>Identical representation as the <code>X509CertificatePath</code> in <a href="#KeyInfo">KeyInfo</a>.</td></tr><tr><td style="white-space:nowrap" id="IssuedCredentials.MAC"><code>&quot;<span style="color:#C00000">MAC</span>&quot;:&nbsp;</code><code>&quot;</code><i>MAC</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td>Caller authentication. See <code>SKS:setCertificatePath.MAC</code>.</td></tr><tr><td style="white-space:nowrap" id="IssuedCredentials.TrustAnchor"><code>&quot;<span style="color:#C00000">TrustAnchor</span>&quot;:&nbsp;</code><i>TrustAnchor</i></td><td style="text-align:center">bool</td><td style="text-align:center">O</td><td><i>Optional:</i> Flag (with the default value <code>false</code>), which tells if <code>X509CertificatePath</code> contains a user-installable trust anchor as well.<div style="height:6pt;padding:0px"></div>Trust anchor installation is meant to be <i>independent</i> of SKS provisioning.</td></tr><tr><td style="white-space:nowrap" id="IssuedCredentials.ImportSymmetricKey"><code>&quot;<span style="color:#C00000">ImportSymmetricKey</span>&quot;:&nbsp;</code><a href="#ImportSymmetricKey">ImportSymmetricKey</a></td><td style="text-align:center">object</td><td style="text-align:center" rowspan="2">O</td><td><i>Optional:</i> Import of raw symmetric key. See <code>SKS:importSymmetricKey</code>.</td></tr><tr><td style="white-space:nowrap" id="IssuedCredentials.ImportPrivateKey"><code>&quot;<span style="color:#C00000">ImportPrivateKey</span>&quot;:&nbsp;</code><a href="#ImportPrivateKey">ImportPrivateKey</a></td><td style="text-align:center">object</td><td><i>Optional:</i> Import of private key in PKCS #8 <a href="#Reference.RFC5208">[RFC5208]</a> format. See <code>SKS:importPrivateKey</code>.</td></tr><tr><td style="white-space:nowrap" id="IssuedCredentials.UpdateKey"><code>&quot;<span style="color:#C00000">UpdateKey</span>&quot;:&nbsp;</code><a href="#UpdateKey">UpdateKey</a></td><td style="text-align:center">object</td><td style="text-align:center" rowspan="2">O</td><td><i>Optional</i>: See <code>SKS:postUpdateKey</code>.</td></tr><tr><td style="white-space:nowrap" id="IssuedCredentials.CloneKeyProtection"><code>&quot;<span style="color:#C00000">CloneKeyProtection</span>&quot;:&nbsp;</code><a href="#CloneKeyProtection">CloneKeyProtection</a></td><td style="text-align:center">object</td><td><i>Optional</i>: See <code>SKS:postCloneKeyProtection</code>.</td></tr><tr><td style="white-space:nowrap" id="IssuedCredentials.Extensions"><code>&quot;<span style="color:#C00000">Extensions</span>&quot;:&nbsp;</code>[<a href="#Extensions" style="margin-left:2pt;margin-right:2pt;">Extensions</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional:</i> List of extension objects. See <code>SKS:addExtension</code>.</td></tr><tr><td style="white-space:nowrap" id="IssuedCredentials.EncryptedExtensions"><code>&quot;<span style="color:#C00000">EncryptedExtensions</span>&quot;:&nbsp;</code>[<a href="#EncryptedExtensions" style="margin-left:2pt;margin-right:2pt;">EncryptedExtensions</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional:</i> List of encrypted extension objects. See <code>SKS:addExtension</code>.</td></tr><tr><td style="white-space:nowrap" id="IssuedCredentials.PropertyBags"><code>&quot;<span style="color:#C00000">PropertyBags</span>&quot;:&nbsp;</code>[<a href="#PropertyBags" style="margin-left:2pt;margin-right:2pt;">PropertyBags</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional:</i> List of property objects. See <code>SKS:addExtension</code>.</td></tr><tr><td style="white-space:nowrap" id="IssuedCredentials.Logotypes"><code>&quot;<span style="color:#C00000">Logotypes</span>&quot;:&nbsp;</code>[<a href="#Logotypes" style="margin-left:2pt;margin-right:2pt;">Logotypes</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional:</i> List of logotype objects. See <code>SKS:addExtension</code>.</td></tr><tr><td colspan="4" style="background-color:white;border-width:0px;padding:10pt 0pt 0pt 0pt">Due to the stateful MAC-scheme featured in SKS, the properties beginning with <code>ImportSymmetricKey</code> and ending with <code>Logotypes</code>, <b>must</b> <i>be generated (by the issuer) and executed (by the SKS) in exactly the order they are declared in this table as well as in associated object arrays</i>.<div style="height:6pt;padding:0px"></div>Note that that credential <code>ID</code>s are not guaranteed to be supplied in the same order as during the associated <a href="#KeyCreationRequest">KeyCreationRequest</a>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="CloneKeyProtection"><i>CloneKeyProtection</i></span>, &nbsp;<span id="DeleteKeys"><i>DeleteKeys</i></span>, &nbsp;<span id="UnlockKeys"><i>UnlockKeys</i></span>, &nbsp;<span id="UpdateKey"><i>UpdateKey</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="CloneKeyProtection.FingerPrint"><code>&quot;<span style="color:#C00000">FingerPrint</span>&quot;:&nbsp;</code><code>&quot;</code><i>FingerPrint</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td>SHA256 fingerprint of target certificate.</td></tr><tr><td style="white-space:nowrap" id="CloneKeyProtection.ServerSessionID"><code>&quot;<span style="color:#C00000">ServerSessionID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ServerSessionID</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td>For locating the target key.</td></tr><tr><td style="white-space:nowrap" id="CloneKeyProtection.ClientSessionID"><code>&quot;<span style="color:#C00000">ClientSessionID</span>&quot;:&nbsp;</code><code>&quot;</code><i>ClientSessionID</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td>For locating the target key.</td></tr><tr><td style="white-space:nowrap" id="CloneKeyProtection.Authorization"><code>&quot;<span style="color:#C00000">Authorization</span>&quot;:&nbsp;</code><code>&quot;</code><i>Authorization</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td>See &quot;Target Key Reference&quot; in the SKS reference.</td></tr><tr><td style="white-space:nowrap" id="CloneKeyProtection.MAC"><code>&quot;<span style="color:#C00000">MAC</span>&quot;:&nbsp;</code><code>&quot;</code><i>MAC</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td>Caller authentication. See <code>SKS:post* </code> methods<code>.MAC</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="EncryptedExtensions"><i>EncryptedExtensions</i></span>, &nbsp;<span id="Extensions"><i>Extensions</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="EncryptedExtensions.Type"><code>&quot;<span style="color:#C00000">Type</span>&quot;:&nbsp;</code><code>&quot;</code><i>Type</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td>Extension type URI.</td></tr><tr><td style="white-space:nowrap" id="EncryptedExtensions.ExtensionData"><code>&quot;<span style="color:#C00000">ExtensionData</span>&quot;:&nbsp;</code><code>&quot;</code><i>ExtensionData</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td>Extension data.</td></tr><tr><td style="white-space:nowrap" id="EncryptedExtensions.MAC"><code>&quot;<span style="color:#C00000">MAC</span>&quot;:&nbsp;</code><code>&quot;</code><i>MAC</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td>Caller authentication. See <code>SKS:addExtension.MAC</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="Logotypes"><i>Logotypes</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="Logotypes.Type"><code>&quot;<span style="color:#C00000">Type</span>&quot;:&nbsp;</code><code>&quot;</code><i>Type</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td>Logotype type URI.</td></tr><tr><td style="white-space:nowrap" id="Logotypes.MimeType"><code>&quot;<span style="color:#C00000">MimeType</span>&quot;:&nbsp;</code><code>&quot;</code><i>MimeType</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td>Logotype MIME type.</td></tr><tr><td style="white-space:nowrap" id="Logotypes.ExtensionData"><code>&quot;<span style="color:#C00000">ExtensionData</span>&quot;:&nbsp;</code><code>&quot;</code><i>ExtensionData</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td>Logotype image data.</td></tr><tr><td style="white-space:nowrap" id="Logotypes.MAC"><code>&quot;<span style="color:#C00000">MAC</span>&quot;:&nbsp;</code><code>&quot;</code><i>MAC</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td>Caller authentication. See <code>SKS:addExtension.MAC</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="PropertyBags"><i>PropertyBags</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="PropertyBags.Type"><code>&quot;<span style="color:#C00000">Type</span>&quot;:&nbsp;</code><code>&quot;</code><i>Type</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td>Property bag type URI. See <code>SKS:addExtension</code>.</td></tr><tr><td style="white-space:nowrap" id="PropertyBags.Properties"><code>&quot;<span style="color:#C00000">Properties</span>&quot;:&nbsp;</code>[<a href="#Properties" style="margin-left:2pt;margin-right:2pt;">Properties</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">Y</td><td>List of property values. See <code>SKS:addExtension</code>.</td></tr><tr><td style="white-space:nowrap" id="PropertyBags.MAC"><code>&quot;<span style="color:#C00000">MAC</span>&quot;:&nbsp;</code><code>&quot;</code><i>MAC</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td>Caller authentication. See <code>SKS:addExtension.MAC</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="Properties"><i>Properties</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="Properties.Name"><code>&quot;<span style="color:#C00000">Name</span>&quot;:&nbsp;</code><code>&quot;</code><i>Name</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td>Property name.</td></tr><tr><td style="white-space:nowrap" id="Properties.Value"><code>&quot;<span style="color:#C00000">Value</span>&quot;:&nbsp;</code><code>&quot;</code><i>Value</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td>Property value.</td></tr><tr><td style="white-space:nowrap" id="Properties.Writable"><code>&quot;<span style="color:#C00000">Writable</span>&quot;:&nbsp;</code><i>Writable</i></td><td style="text-align:center">bool</td><td style="text-align:center">O</td><td>Writable flag. Default is <code>false</code>.  See <code>SKS:setProperty</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="ImportPrivateKey"><i>ImportPrivateKey</i></span>, &nbsp;<span id="ImportSymmetricKey"><i>ImportSymmetricKey</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="ImportPrivateKey.EncryptedKey"><code>&quot;<span style="color:#C00000">EncryptedKey</span>&quot;:&nbsp;</code><code>&quot;</code><i>EncryptedKey</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td>Encrypted key material.  See <code>SKS:import* </code> methods<code>.EncryptedKey</code>.</td></tr><tr><td style="white-space:nowrap" id="ImportPrivateKey.MAC"><code>&quot;<span style="color:#C00000">MAC</span>&quot;:&nbsp;</code><code>&quot;</code><i>MAC</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td>Caller authentication. See <code>SKS:import* </code>methods<code>.MAC</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="ClientAttributes"><i>ClientAttributes</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="ClientAttributes.Type"><code>&quot;<span style="color:#C00000">Type</span>&quot;:&nbsp;</code><code>&quot;</code><i>Type</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td>Client attribute type URI.</td></tr><tr><td style="white-space:nowrap" id="ClientAttributes.Values"><code>&quot;<span style="color:#C00000">Values</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>Values</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;0-n</span></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td>List of attributes associated with <code>Type</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="ImagePreferences"><i>ImagePreferences</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="ImagePreferences.Type"><code>&quot;<span style="color:#C00000">Type</span>&quot;:&nbsp;</code><code>&quot;</code><i>Type</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td>Image type URI. See <a href="#PlatformNegotiationResponse">PlatformNegotiationResponse</a>.</td></tr><tr><td style="white-space:nowrap" id="ImagePreferences.MimeType"><code>&quot;<span style="color:#C00000">MimeType</span>&quot;:&nbsp;</code><code>&quot;</code><i>MimeType</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td>Image MIME type. See <a href="#PlatformNegotiationResponse">PlatformNegotiationResponse</a>.</td></tr><tr><td style="white-space:nowrap" id="ImagePreferences.Width"><code>&quot;<span style="color:#C00000">Width</span>&quot;:&nbsp;</code><code>&quot;</code><i>Width</i><code>&quot;</code></td><td style="text-align:center">int</td><td style="text-align:center">Y</td><td>Image width. See <a href="#PlatformNegotiationResponse">PlatformNegotiationResponse</a>.</td></tr><tr><td style="white-space:nowrap" id="ImagePreferences.Height"><code>&quot;<span style="color:#C00000">Height</span>&quot;:&nbsp;</code><code>&quot;</code><i>Height</i><code>&quot;</code></td><td style="text-align:center">int</td><td style="text-align:center">Y</td><td>Image height. See <a href="#PlatformNegotiationResponse">PlatformNegotiationResponse</a>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="DeviceCertificate"><i>DeviceCertificate</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="DeviceCertificate.X509CertificatePath"><code>&quot;<span style="color:#C00000">X509CertificatePath</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>Sorted Certificate Path</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td>Identical representation as the <code>X509CertificatePath</code> in <a href="#KeyInfo">KeyInfo</a>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="ServerEphemeralKey"><i>ServerEphemeralKey</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="ServerEphemeralKey.PublicKey"><code>&quot;<span style="color:#C00000">PublicKey</span>&quot;:&nbsp;</code><a href="#PublicKey">PublicKey</a></td><td style="text-align:center">object</td><td style="text-align:center">Y</td><td><code>ServerEphemeralKey</code> <b>must</b> be an EC key matching the capabilities of the SKS.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="ClientEphemeralKey"><i>ClientEphemeralKey</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="ClientEphemeralKey.PublicKey"><code>&quot;<span style="color:#C00000">PublicKey</span>&quot;:&nbsp;</code><a href="#PublicKey">PublicKey</a></td><td style="text-align:center">object</td><td style="text-align:center">Y</td><td><code>ClientEphemeralKey</code> <b>must</b> be an EC key using the same curve as <code>ServerEphemeralKey</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="Signature"><i>Signature</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="Signature.Version"><code>&quot;<span style="color:#C00000">Version</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/jcs/v1</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">O</td><td><a href="#Reference.JCS">[JCS]</a>: <i>Optional</i> signature object version identifier.</td></tr><tr><td style="white-space:nowrap" id="Signature.Algorithm"><code>&quot;<span style="color:#C00000">Algorithm</span>&quot;:&nbsp;</code><code>&quot;</code><i>Algorithm</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td><a href="#Reference.JCS">[JCS]</a>: Signature algorithm URI. See SKS &quot;Algorithm Support&quot;.<div style="height:6pt;padding:0px"></div>The currently recognized symmetric key algorithms include:<ul><li><code>http://www.w3.org/2000/09/xmldsig#hmac-sha1</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#hmac-sha256</code></li><li><code style="color:#A0A0A0">http://www.w3.org/2001/04/xmldsig-more#hmac-sha384</code></li><li><code style="color:#A0A0A0">http://www.w3.org/2001/04/xmldsig-more#hmac-sha512</code></li></ul>The currently recognized asymmetric key algorithms include:<ul><li><code>http://www.w3.org/2000/09/xmldsig#rsa-sha1</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#rsa-sha256</code></li><li><code style="color:#A0A0A0">http://www.w3.org/2001/04/xmldsig-more#rsa-sha384</code></li><li><code style="color:#A0A0A0">http://www.w3.org/2001/04/xmldsig-more#rsa-sha512</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha1</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha256</code></li><li><code style="color:#A0A0A0">http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha384</code></li><li><code style="color:#A0A0A0">http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha512</code></li></ul>For detailed descriptions of these algorithms, see XML&nbsp;DSig <a href="#Reference.XMLDSIG">[XMLDSIG]</a>.</td></tr><tr><td style="white-space:nowrap" id="Signature.KeyInfo"><code>&quot;<span style="color:#C00000">KeyInfo</span>&quot;:&nbsp;</code><a href="#KeyInfo">KeyInfo</a></td><td style="text-align:center">object</td><td style="text-align:center">Y</td><td><a href="#Reference.JCS">[JCS]</a>: Signature key information placeholder.</td></tr><tr><td style="white-space:nowrap" id="Signature.SignatureValue"><code>&quot;<span style="color:#C00000">SignatureValue</span>&quot;:&nbsp;</code><code>&quot;</code><i>SignatureValue</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">Y</td><td><a href="#Reference.JCS">[JCS]</a>: The signature value is calculated by applying the algorithm specified in <code>Algorithm</code> using the key specified in <code>KeyInfo</code> on the <span style="white-space:nowrap">UTF-8</span> representation of the canonicalized JSON object.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="KeyInfo"><i>KeyInfo</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="KeyInfo.KeyID"><code>&quot;<span style="color:#C00000">KeyID</span>&quot;:&nbsp;</code><code>&quot;</code><i>KeyID</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center" rowspan="4">Y</td><td><a href="#Reference.JCS">[JCS]</a> option: Symmetric key ID.</td></tr><tr><td style="white-space:nowrap" id="KeyInfo.PublicKey"><code>&quot;<span style="color:#C00000">PublicKey</span>&quot;:&nbsp;</code><a href="#PublicKey">PublicKey</a></td><td style="text-align:center">object</td><td><a href="#Reference.JCS">[JCS]</a> option: Public key.</td></tr><tr><td style="white-space:nowrap" id="KeyInfo.URL"><code>&quot;<span style="color:#C00000">URL</span>&quot;:&nbsp;</code><code>&quot;</code><i>URL</i><code>&quot;</code></td><td style="text-align:center">uri</td><td><a href="#Reference.JCS">[JCS]</a> option: A single public key or X.509 <a href="#Reference.RFC5280">[RFC5280]</a> certificate path stored in a PEM <a href="#Reference.PEM">[PEM]</a> file accessible via an HTTP&nbsp;URL.<div style="height:6pt;padding:0px"></div>The <i>signing key's</i> algorithm <b>must</b> be compatible with those specified for <a href="#PublicKey">PublicKey</a>.<div style="height:6pt;padding:0px"></div>Note that the <code>URL</code> option is <i>not</i> used by KeyGen2.</td></tr><tr><td style="white-space:nowrap" id="KeyInfo.X509CertificatePath"><code>&quot;<span style="color:#C00000">X509CertificatePath</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>Sorted Certificate Path</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">base64</td><td><a href="#Reference.JCS">[JCS]</a> option: Sorted X.509 <a href="#Reference.RFC5280">[RFC5280]</a> certificate path where the <i>first</i> array element <b>must</b> contain the <i style="white-space:nowrap">signature certificate</i>. The certificate path <b>must</b> be <i>contiguous</i> but is not required to be complete.<div style="height:6pt;padding:0px"></div>The <i>signing key's</i> algorithm <b>must</b> be compatible with those specified for <a href="#PublicKey">PublicKey</a>.</td></tr><tr><td style="white-space:nowrap" id="KeyInfo.SignatureCertificate"><code>&quot;<span style="color:#C00000">SignatureCertificate</span>&quot;:&nbsp;</code><a href="#SignatureCertificate">SignatureCertificate</a></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><a href="#Reference.JCS">[JCS]</a>: <i>Optional</i> signature certificate attribute data for usage with the <code>X509CertificatePath</code> option.<div style="height:6pt;padding:0px"></div>A compliant JCS implementation <b>must</b> verify that the <code>SignatureCertificate</code> object matches the first certificate in the <code>X509CertificatePath</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="PublicKey"><i>PublicKey</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="PublicKey.EC"><code>&quot;<span style="color:#C00000">EC</span>&quot;:&nbsp;</code><a href="#EC">EC</a></td><td style="text-align:center">object</td><td style="text-align:center" rowspan="2">Y</td><td><a href="#Reference.JCS">[JCS]</a> option: EC public key.</td></tr><tr><td style="white-space:nowrap" id="PublicKey.RSA"><code>&quot;<span style="color:#C00000">RSA</span>&quot;:&nbsp;</code><a href="#RSA">RSA</a></td><td style="text-align:center">object</td><td><a href="#Reference.JCS">[JCS]</a> option: RSA public key. <i>Algorithm restrictions</i>: 1024-4096 bit keys appear to work just about &quot;everywhere&quot;.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="EC"><i>EC</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="EC.NamedCurve"><code>&quot;<span style="color:#C00000">NamedCurve</span>&quot;:&nbsp;</code><code>&quot;</code><i>NamedCurve</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">Y</td><td><a href="#Reference.JCS">[JCS]</a>: EC named curve. See SKS &quot;Algorithm Support&quot;.<div style="height:6pt;padding:0px"></div>The currently recognized EC curves include:<ul><li><code style="color:#A0A0A0">http://xmlns.webpki.org/sks/algorithm#ec.nist.b163</code></li><li><code style="color:#A0A0A0">http://xmlns.webpki.org/sks/algorithm#ec.nist.b233</code></li><li><code style="color:#A0A0A0">http://xmlns.webpki.org/sks/algorithm#ec.nist.b283</code></li><li><code style="color:#A0A0A0">http://xmlns.webpki.org/sks/algorithm#ec.nist.p192</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#ec.nist.p256</code></li><li><code style="color:#A0A0A0">http://xmlns.webpki.org/sks/algorithm#ec.nist.p384</code></li><li><code style="color:#A0A0A0">http://xmlns.webpki.org/sks/algorithm#ec.nist.p521</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#ec.brainpool.p256r1</code></li></ul></td></tr><tr><td style="white-space:nowrap" id="EC.X"><code>&quot;<span style="color:#C00000">X</span>&quot;:&nbsp;</code><code>&quot;</code><i>X</i><code>&quot;</code></td><td style="text-align:center">crypto</td><td style="text-align:center">Y</td><td><a href="#Reference.JCS">[JCS]</a>: EC curve point X.</td></tr><tr><td style="white-space:nowrap" id="EC.Y"><code>&quot;<span style="color:#C00000">Y</span>&quot;:&nbsp;</code><code>&quot;</code><i>Y</i><code>&quot;</code></td><td style="text-align:center">crypto</td><td style="text-align:center">Y</td><td><a href="#Reference.JCS">[JCS]</a>: EC curve point Y.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="RSA"><i>RSA</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="RSA.Modulus"><code>&quot;<span style="color:#C00000">Modulus</span>&quot;:&nbsp;</code><code>&quot;</code><i>Modulus</i><code>&quot;</code></td><td style="text-align:center">crypto</td><td style="text-align:center">Y</td><td><a href="#Reference.JCS">[JCS]</a>: RSA modulus.</td></tr><tr><td style="white-space:nowrap" id="RSA.Exponent"><code>&quot;<span style="color:#C00000">Exponent</span>&quot;:&nbsp;</code><code>&quot;</code><i>Exponent</i><code>&quot;</code></td><td style="text-align:center">crypto</td><td style="text-align:center">Y</td><td><a href="#Reference.JCS">[JCS]</a>: RSA exponent.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="SignatureCertificate"><i>SignatureCertificate</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="SignatureCertificate.Issuer"><code>&quot;<span style="color:#C00000">Issuer</span>&quot;:&nbsp;</code><code>&quot;</code><i>Issuer</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td><a href="#Reference.JCS">[JCS]</a>: Issuer distinguished name in LDAP <a href="#Reference.RFC4514">[RFC4514]</a> notation.</td></tr><tr><td style="white-space:nowrap" id="SignatureCertificate.SerialNumber"><code>&quot;<span style="color:#C00000">SerialNumber</span>&quot;:&nbsp;</code><i>SerialNumber</i></td><td style="text-align:center">bigint</td><td style="text-align:center">Y</td><td><a href="#Reference.JCS">[JCS]</a>: Certificate serial number.</td></tr><tr><td style="white-space:nowrap" id="SignatureCertificate.Subject"><code>&quot;<span style="color:#C00000">Subject</span>&quot;:&nbsp;</code><code>&quot;</code><i>Subject</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">Y</td><td><a href="#Reference.JCS">[JCS]</a>: Subject distinguished name in LDAP <a href="#Reference.RFC4514">[RFC4514]</a> notation.</td></tr></table><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Sample_Run"><span style="font-size:14pt">Appendix A:&nbsp;Sample Run</span></div>In the following KeyGen2 sample run the client (platform) suggests a suitable image size for logotypes associated with keys.<div style="height:6pt;padding:0px"></div>Then the issuer requests that the client (SKS) creates an RSA 2048-bit key protected by a user-set PIN governed by a number of issuer-defined policies.<div style="height:6pt;padding:0px"></div>Finally, the issuer provides a certificate and and a logotype to go with it.<div style="height:6pt;padding:0px"></div>For information regarding the cryptographic constructs, consult the SKS architecture manual.<table class="tftable" style="margin-top:10pt"><tr><th id="Sample.PlatformNegotiationRequest">PlatformNegotiationRequest</th></tr><tr><td><code>{<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20131201</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">PlatformNegotiationRequest</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">ServerSessionID</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">142f1bdb286XVQnqmIRc1bSzm-QN-ZJk</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">SubmitURL</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://issuer.example.com/platform</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">Action</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">manage</span>&quot;<br>}</code></td></tr><tr><td style="border-width:0px;height:10px;background-color:white"></td></tr><tr><th id="Sample.PlatformNegotiationResponse">PlatformNegotiationResponse</th></tr><tr><td><code>{<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20131201</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">PlatformNegotiationResponse</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">ServerSessionID</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">142f1bdb286XVQnqmIRc1bSzm-QN-ZJk</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">ImagePreferences</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;[{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">Type</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/logotype#list</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">MimeType</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">image/png</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">Width</span>&quot;:&nbsp;<span style="color:#008000">94</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">Height</span>&quot;:&nbsp;<span style="color:#008000">74</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}]<br>}</code></td></tr><tr><td style="border-width:0px;height:10px;background-color:white"></td></tr><tr><th id="Sample.ProvisioningInitializationRequest">ProvisioningInitializationRequest</th></tr><tr><td><code>{<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20131201</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">ProvisioningInitializationRequest</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">ServerSessionID</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">142f1bdb286XVQnqmIRc1bSzm-QN-ZJk</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">SubmitURL</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://issuer.example.com/provsess</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">ServerTime</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">2013-12-14T16:33:30+01:00</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">SessionKeyAlgorithm</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/sks/algorithm#session.1</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">SessionKeyLimit</span>&quot;:&nbsp;<span style="color:#008000">20</span>,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">SessionLifeTime</span>&quot;:&nbsp;<span style="color:#008000">300</span>,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">ServerEphemeralKey</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">PublicKey</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">EC</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">NamedCurve</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/sks/algorithm#ec.nist.p256</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">X</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">cpxUxJVt-is8bgWRFm6RuvUkxyv7xJ7PbeT1BCQNNws</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">Y</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">De7jXYsdL46ikHOWeC-V-AcNM/RURpu6ZgcVAxLUwns</span>&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}</code></td></tr><tr><td style="border-width:0px;height:10px;background-color:white"></td></tr><tr><th id="Sample.ProvisioningInitializationResponse">ProvisioningInitializationResponse</th></tr><tr><td><code>{<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20131201</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">ProvisioningInitializationResponse</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">ServerSessionID</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">142f1bdb286XVQnqmIRc1bSzm-QN-ZJk</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">ClientSessionID</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">39NMWamKtHumJFfdIGkDrLP-NMB-5Lwo</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">ServerTime</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">2013-12-14T16:33:30+01:00</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">ClientTime</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">2013-12-14T16:33:30+01:00</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">SessionAttestation</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">KMUpOesC8nDTLpu8PppsSGg1j....WiwvUcVpbNudbY14lLks8RQuwoiU</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">ClientEphemeralKey</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">PublicKey</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">EC</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">NamedCurve</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/sks/algorithm#ec.nist.p256</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">X</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">tQXczn7qxGgcLpOVBuw5i-tMHxbJTUF6k3RZGsjdauc</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">Y</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">jIlm8sXwknZeQQDTxkfwXKUdhubt6JcqQYA6S8Dm3AE</span>&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">DeviceCertificate</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">X509CertificatePath</span>&quot;:&nbsp;[&quot;<span style="color:#0000C0">MIIC2DCCAcCgAwIBAgIGARTWcc7VMCSq....awCV4OfAGXLIwJBCp85AN7KNdcJfL</span>&quot;]<br>&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">ServerCertificateFingerPrint</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">HwKCofkqkTFXRmyyb_CnWhAcTbQF7w8rl1OqCwyM4TM</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">Signature</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">Algorithm</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://www.w3.org/2001/04/xmldsig-more#hmac-sha256</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">KeyInfo</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">KeyID</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">derived-session-key</span>&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">SignatureValue</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">nnzNSZUZw1qlGVydZZ3ssCVIZTznyHwDXlOpLMpI3Lo</span>&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}</code></td></tr><tr><td style="border-width:0px;height:10px;background-color:white"></td></tr><tr><th id="Sample.KeyCreationRequest">KeyCreationRequest</th></tr><tr><td><code>{<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20131201</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">KeyCreationRequest</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">ServerSessionID</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">142f1bdb286XVQnqmIRc1bSzm-QN-ZJk</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">ClientSessionID</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">39NMWamKtHumJFfdIGkDrLP-NMB-5Lwo</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">SubmitURL</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://issuer.example.com/keyinit</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">KeyEntryAlgorithm</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/sks/algorithm#key.1</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">PINPolicySpecifiers</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;[{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">ID</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">PIN.1</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">MinLength</span>&quot;:&nbsp;<span style="color:#008000">4</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">MaxLength</span>&quot;:&nbsp;<span style="color:#008000">8</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">RetryLimit</span>&quot;:&nbsp;<span style="color:#008000">3</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">Format</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">numeric</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">PatternRestrictions</span>&quot;:&nbsp;[&quot;<span style="color:#0000C0">three-in-a-row</span>&quot;,&quot;<span style="color:#0000C0">sequence</span>&quot;],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">MAC</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">2aUMRubbEk8Xs62QXlPiFJbYlJ68Sw4Fhu48j4uGKXk</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">KeyEntrySpecifiers</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">ID</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">Key.1</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">AppUsage</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">authentication</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">KeyAlgorithm</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/sks/algorithm#rsa2048</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">MAC</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">BQpWMwSz4EsYgliHH6RY3UNWuLsR3eJVapY0CYOUTtI</span>&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}]<br>}</code></td></tr><tr><td style="border-width:0px;height:10px;background-color:white"></td></tr><tr><th id="Sample.KeyCreationResponse">KeyCreationResponse</th></tr><tr><td><code>{<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20131201</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">KeyCreationResponse</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">ServerSessionID</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">142f1bdb286XVQnqmIRc1bSzm-QN-ZJk</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">ClientSessionID</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">39NMWamKtHumJFfdIGkDrLP-NMB-5Lwo</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">GeneratedKeys</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;[{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">ID</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">Key.1</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">PublicKey</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">RSA</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">Modulus</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">uSW5wpfano32Q6oU3xMkFig0r145DN....jkjy1ENPdBQaafvJnuh4x58WPTsVCvjimw</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">Exponent</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">AQAB</span>&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">KeyAttestation</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">gyRmTPdW4UdGdXlLkHf40PPRL9xac31eJnyyBtf7-Io</span>&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}]<br>}</code></td></tr><tr><td style="border-width:0px;height:10px;background-color:white"></td></tr><tr><th id="Sample.ProvisioningFinalizationRequest">ProvisioningFinalizationRequest</th></tr><tr><td><code>{<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20131201</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">ProvisioningFinalizationRequest</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">ServerSessionID</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">142f1bdb286XVQnqmIRc1bSzm-QN-ZJk</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">ClientSessionID</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">39NMWamKtHumJFfdIGkDrLP-NMB-5Lwo</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">SubmitURL</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://issuer.example.com/finalize</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">IssuedCredentials</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;[{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">ID</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">Key.1</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">X509CertificatePath</span>&quot;:&nbsp;[&quot;<span style="color:#0000C0">MIICmDCCAYCgAwIBAgIGAULxF0G....UimDl7Dt7733M0TT8qSpXeYvV0NLX5kM</span>&quot;],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">MAC</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">FkwauPbrrfJZxuEsMkwOFWIIutzdYbEt3P9kr0CG4dc</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">Logotypes</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">Type</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/logotype#list</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">MimeType</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">image/png</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">ExtensionData</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">RBgoJkiaJk_IsZAEZUBsZAEZFg....NVBAMTC0RlbW8gU3ViIENBMBTEzMM1oDTM4</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">MAC</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">uQ5IuLRDpbSkpfU9FHe1grrQ_FXUBfsxsk6HqspjuCU</span>&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}],<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">Challenge</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">_U9YmqyULox2Q53F4l9pQaxjbzlOu2wMo6_FgGAmooQ</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">MAC</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">_e0T_svX9vXQTuyIxDUmmteM2IwvXbSOEREuqbe7fS4</span>&quot;<br>}</code></td></tr><tr><td style="border-width:0px;height:10px;background-color:white"></td></tr><tr><th id="Sample.ProvisioningFinalizationResponse">ProvisioningFinalizationResponse</th></tr><tr><td><code>{<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20131201</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">ProvisioningFinalizationResponse</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">ServerSessionID</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">142f1bdb286XVQnqmIRc1bSzm-QN-ZJk</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">ClientSessionID</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">39NMWamKtHumJFfdIGkDrLP-NMB-5Lwo</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">CloseAttestation</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">Oy8QaNN0orkE2gxlCWrMYHxDNr6m5FTdVpqTqF9eXlI</span>&quot;<br>}</code></td></tr></table></div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Aknowledgements"><span style="font-size:14pt">Appendix B:&nbsp;Aknowledgements</span></div>The design of the KeyGen2 protocol was &quot;inspired&quot; by several predecessors, most notably IETF's DSKPP <a href="#Reference.RFC6063">[RFC6063]</a>.<div style="height:6pt;padding:0px"></div>Funding has been provided by <i>PrimeKey Solutions AB</i> and the <i>Swedish Innovation Board (VINNOVA)</i>.</div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="References"><span style="font-size:14pt">Appendix C:&nbsp;References</span></div></div><table class="tftable" style="width:600pt"><tr><th>Reference</th><th>Description</th></tr><tr><td id="Reference.JCS" style="white-space:nowrap">[JCS]</td><td>Rundgren, A., "JCS - JSON Cleartext Signature", Work in progress, <a target="_blank" title="External link opened in a new windows" href="https://openkeystore.googlecode.com/svn/resources/trunk/docs/jcs.html">https://openkeystore.googlecode.com/svn/resources/trunk/docs/jcs.html</a>, <span style="white-space: nowrap">December&nbsp;2013.</span></td></tr><tr><td id="Reference.PEM" style="white-space:nowrap">[PEM]</td><td>Josefsson, S., "Text Encodings of PKIX and CMS Structures", I-D, draft-josefsson-pkix-textual-02, October&nbsp;2013.</td></tr><tr><td id="Reference.RFC3986" style="white-space:nowrap">[RFC3986]</td><td>Berners-Lee, T., Fielding, R., and L. Masinter, "Uniform Resource Identifier (URI): Generic Syntax", RFC&nbsp;3986, January&nbsp;2005.</td></tr><tr><td id="Reference.RFC4210" style="white-space:nowrap">[RFC4210]</td><td>Adams, C., Farrell, S., Kause, T., and T. Mononen, "Internet X.509 Public Key Infrastructure Certificate Management Protocol (CMP)", RFC&nbsp;4210, September&nbsp;2005.</td></tr><tr><td id="Reference.RFC4514" style="white-space:nowrap">[RFC4514]</td><td>Zeilenga, K., "Lightweight Directory Access Protocol (LDAP): String Representation of Distinguished Names", RFC&nbsp;4514, June&nbsp;2006.</td></tr><tr><td id="Reference.RFC4627" style="white-space:nowrap">[RFC4627]</td><td>Crockford, D., "The application/json Media Type for JavaScript Object Notation (JSON)", RFC&nbsp;4627, July&nbsp;2006.</td></tr><tr><td id="Reference.RFC4648" style="white-space:nowrap">[RFC4648]</td><td>Josefsson, S., "The Base16, Base32, and Base64 Data Encodings", RFC&nbsp;4648, October&nbsp;2006.</td></tr><tr><td id="Reference.RFC5208" style="white-space:nowrap">[RFC5208]</td><td>Kaliski, B., "Public-Key Cryptography Standards (PKCS) #8: Private-Key Information Syntax Specification Version 1.2", RFC&nbsp;5208, May&nbsp;2008.</td></tr><tr><td id="Reference.RFC5280" style="white-space:nowrap">[RFC5280]</td><td>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, "Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile", RFC&nbsp;5280, May&nbsp;2008.</td></tr><tr><td id="Reference.RFC6063" style="white-space:nowrap">[RFC6063]</td><td>Doherty, A., Pei, M., Machani, S., and M. Nystrom, "Dynamic Symmetric Key Provisioning Protocol (DSKPP)", RFC&nbsp;6063, December&nbsp;2010.</td></tr><tr><td id="Reference.SKS" style="white-space:nowrap">[SKS]</td><td>Rundgren, A., "Secure Key Store (SKS) - API and Architecture", Work in progress, <a target="_blank" title="External link opened in a new windows" href="https://openkeystore.googlecode.com/svn/resources/trunk/docs/sks-api-arch.pdf">https://openkeystore.googlecode.com/svn/resources/trunk/docs/sks-api-arch.pdf</a>, <span style="white-space: nowrap">V0.97, December 2013.</span></td></tr><tr><td id="Reference.XMLDSIG" style="white-space:nowrap">[XMLDSIG]</td><td>"XML-Signature Syntax and Processing", D. Eastlake 3rd, J. Reagle, D. Solo, June&nbsp;2008. <a target="_blank" title="External link opened in a new windows" href="http://www.w3.org/TR/xmldsig-core/">http://www.w3.org/TR/xmldsig-core/</a></td></tr></table><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Document_History"><span style="font-size:14pt">Appendix D:&nbsp;Document History</span></div><table class="tftable"><tr><th>Date</th><th>Ver</th><th>Comment</th></tr><tr><td>2013-12-28</td><td style="text-align:center">0.2</td><td>Not yet released document :-)</td></tr></table></div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Author"><span style="font-size:14pt">Appendix E:&nbsp;Author</span></div>KeyGen2 was primarily developed by Anders Rundgren (<code>anders.rundgren.net@gmail.com</code>).</div></body></html>